#include "../include/main.h"
#include "../include/fmodel.h"
using namespace std;

v1Assembly::v1Assembly(Fmodel fmodel,double f)
{
    
    w=2*M_PI*f;
    mu0=(4e-7)*M_PI;
    m_len=fmodel.NZ+1;
    datasetSize=N_MODEL_Z+1;
   // printf("m_len=%d\n",m_len);
    //闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鎯у⒔閹虫捇鈥旈崘顏佸亾閿濆簼绨奸柟鐧哥秮閺岋綁顢橀悙鎼闂侀潧妫欑敮鎺楋綖濠靛鏅查柛娑卞墮椤ユ艾鈹戞幊閸婃鎱ㄩ悜钘夌；婵炴垟鎳為崶顒佸仺缂佸瀵ч悗顒勬倵楠炲灝鍔氭い锔诲灣缁牏鈧綆鍋佹禍婊堟煙閸濆嫮肖闁告柨绉甸妵鍕棘閹稿骸顦╃紓浣虹帛缁诲倿顢氶妷鈺傜叆閻庯綆鍋嗛崙锟犳⒑闁偛鑻晶顖涚箾閼碱剙鏋庨柣锝囧厴椤㈡盯鎮滈崱妯绘珫婵犳鍠楁灙濡炲枪閳绘挻銈ｉ崘鈹炬嫼闂佸憡绻傜€氼垶锝為敃鍌涚厱閹兼番鍨婚崣鈧梺璇″櫙缁绘繂顕ｉ幘顔藉亹妞ゆ劦婢€婢规洟姊虹粙璺ㄧ妞わ富鍨辩粋宥嗐偅閸愨斁鎷洪梻渚囧亞閸嬫盯鎳熼娑欐珷閻庣數纭堕崑鎾舵喆閸曨剛顦ㄥ┑鐐跺皺閸犳牠鎮伴閿亾閿濆骸鏋熼柛瀣姍閺岋綁濮€閳藉棗鏅卞┑鈥冲级閹倸顫忕紒妯诲闁告稑锕ラ崕鎾剁磽娴ｅ壊鍎庣紒鑸佃壘閻ｇ兘濮€閿涘嫷娴勯柣搴秵閸嬪嫭绂嶅Δ鈧埞鎴︽倷閸欏妫￠梺鍦归…鐑藉箖閿熺姵鍋勯梻鈧幇顔剧暰闂備線娼ч悧鍡涘磹閸涘﹦顩插Δ锝呭暞閳锋垹绱撴担鐧镐緵婵炲牊妫冮弻銊╁即椤忓棛鏆犻梺瀹狀嚙闁帮絾鎱ㄩ埀顒勬煏閸繃顥滄繛鍫涘€曢—鍐Χ閸℃鐟ㄩ梺绋匡工椤兘寮鍛牚闁割偆鍟块幏娲⒒娓氬洤浜為柛瀣洴閹崇喖顢涘☉娆愮彿濡炪倖娲嶉崑鎾绘煛瀹€瀣М闁轰焦鍔欏畷鍗炩枎閹寸姵婢栭梺璇叉唉椤煤濠婂牆绐楅柡宥庡幑閳ь兛绀佽灃闁告侗鍘鹃敍婊冣攽椤旀枻渚涢柛鎾寸洴椤㈡瑩宕堕浣叉嫽闂佺ǹ鏈懝楣冨焵椤掑嫷妫戠紒顔肩墛閹峰懘宕烽鐘查獎濠电姷鏁告慨鏉懨洪妶鍥ь棜濠电姵纰嶉悡鏇㈡煃閳轰礁鏆熼柍钘夘槺缁辨帡骞囬褎鐤侀梺鍝勭焿缁绘繂鐣烽崼鏇炵厸濞达絽娲﹂惄顖炲蓟濞戞埃鍋撻敐搴′簼閻忓繒鏁婚弻娑㈡偐鐠囇勬暰閻庡灚婢樼€氼噣鍩€椤掑﹦绉靛ù婊嗗煐鐎靛ジ鏁撻敓锟�+1=25
    //ExA.resize(m_len,1);
    EpxA.resize(m_len,1);
    EpyA.resize(m_len,1);
    EpzA.resize(m_len,1);
    EpxA.setZero();
    EpyA.setZero();
    EpzA.setZero();
    //EpxB.resize(m_len,1);
   // EpyB.resize(m_len,1);
   // EpzB.resize(m_len,1);
    linshi.resize(datasetSize,1);
    polarization=1;
    //
    Exx1.resize(fmodel.NX);
    for(auto& row : Exx1) {
        row.resize(fmodel.NX); 
    }

    Eyy1.resize(fmodel.NX); 
    for(auto& row : Eyy1) {
        row.resize(fmodel.NX); 
    }

    Ezz1.resize(fmodel.NX); 
    for(auto& row : Ezz1) {
        row.resize(fmodel.NX); 
    }

    Hxx1.resize(fmodel.NX); 
    for(auto& row : Hxx1) {
        row.resize(fmodel.NX); 
    }

    Hyy1.resize(fmodel.NX); 
    for(auto& row : Hyy1) {
        row.resize(fmodel.NX); 
    }

    Hzz1.resize(fmodel.NX);
    for(auto& row : Hzz1) {
        row.resize(fmodel.NX); 
    }
}
v1Assembly::~v1Assembly()
{
    
}

void v1Assembly::creatv1(v0Assembly v0A,Fmodel fmodel,MPI_Comm curComm)
{
    //
    int curRank, curSize;
    MPI_Comm_size(curComm, &curSize);
    MPI_Comm_rank(curComm, &curRank);

    int start1 =MPI_Wtime();
   // int NP=fmodel.NP;
    int NX=fmodel.NX;
    int NY=fmodel.NX;
    int NZ=fmodel.NZ;
    int NL=fmodel.NL;
    int NN=fmodel.NN;
    
    complex<double> myzero(0.0,0.0);
    complex<double> myone(1.0,0.0);
    PetscLogDouble start,endt;  
    PetscTime(&start);
       // cout<<"source A ??"<<endl;
    //v1=sparse(NL,NL);
    Mat v1;
    MatCreate(curComm, &v1);
    MatSetSizes(v1, PETSC_DECIDE, PETSC_DECIDE,NL, NL);
    MatSetFromOptions(v1);
    MatSetUp(v1);
    MatDuplicate(v0A.v0, MAT_COPY_VALUES, &v1);

    Mat copyK3;
    MatCreate(curComm, &copyK3);
    MatSetSizes(copyK3, PETSC_DECIDE, PETSC_DECIDE,NL, NL);
    MatSetFromOptions(copyK3);
    MatSetUp(copyK3);
    MatDuplicate(v0A.K3, MAT_COPY_VALUES, &copyK3);
    //P=sparse(NL,1);
    Vec P;
    VecCreate(curComm, &P);
    VecSetSizes(P, PETSC_DECIDE,NL);
    VecSetFromOptions(P);
    VecSetUp(P);//VecSet(P,myzero);
    
    //Ep=sparse(NL,1);
    Vec Ep;
    VecCreate(curComm, &Ep);
    VecSetSizes(Ep, PETSC_DECIDE,NL);
    VecSetFromOptions(Ep);
    VecSetUp(Ep);
    //X1=zeros(1,NL);
    Vec Xe;
    VecCreate(PETSC_COMM_WORLD, &Xe);
    VecSetSizes(Xe, PETSC_DECIDE, NL);
    VecSetFromOptions(Xe);
    VecSetUp(Xe);

    //fDir
    int ExpAstart=NPML_X;
    int ExpAend=N_MODEL_X+NPML_X+1;
    for(int i=ExpAstart;i<ExpAend;i++)//18-6+1=13
    {
        EpxA(i)=linshi(i-ExpAstart)/linshi(Nair-NPML_Z);//ExA(7:19,1)=linshi(:,1)/linshi(3); 
       // printf("EpxA(i)=%e,%e linshi(i-6)=(%e,%e) linshi(2)=(%e,%e)\n",real(EpxA(i)),imag(EpxA(i)),real(linshi(i-6)),imag(linshi(i-6)),real(linshi(2)),imag(linshi(2)));
       // EpyB(i)=linshi(i-6)/linshi(2);
    }
    for(int i=0;i<ExpAstart;i++)
    {
        EpxA(i)=EpxA(ExpAstart);//ExA(1:6,1)=ExA(7,1);
        //EpyB(i)=EpyB(6);
    }
    for(int i=ExpAend;i<m_len;i++)
    {
        EpxA(i)=EpxA(ExpAend-1);//ExA(20:25,1)=ExA(19,1);
        //EpyB(i)=EpyB(18);
    }
   // for(int i=0;i<25;i++)
    {
      //  printf("EpxA[i]=%e,%e\n",real(EpxA(i)),imag(EpxA(i)));
    }

    vector<complex<double>> Bp(NL+1,myzero);
    //printf("start Bp\n");
    //============EP===============  % Exp
    for(int i=1;i<=NZ+1;i++) 
    {
        for(int j=1;j<=NY+1;j++) // j=1:NY+1
        {
            for(int k=1;k<=NX;k++) //k=1:NX
            {
                int kk=(i-1)*((NX+1)*(NY+1)+(NX+1)*NY+(NY+1)*NX)+(j-1)*(NX+NX+1)+k;
                int h=floor((kk-1)/(NX*(NY+1)+(NX+1)*NY+(NX+1)*(NY+1)))+1;
                Bp[kk-1]=EpxA(h-1);//Ep(kk,1)=EpxA(h,fnn);
            
            }
        }    
    }   
    for(int i=1;i<=NZ+1;i++)// i=1:NZ+1  % Eyp
    {
        for(int j=1;j<=NY;j++)// j=1:NY
        {
            for(int k=1;k<=NX+1;k++)// k=1:NX+1
            {
                int kk=(i-1)*((NX+1)*(NY+1)+(NX+1)*NY+(NY+1)*NX)+(j-1)*(NX+NX+1)+NX+k;
                int h=floor((kk-1)/(NX*(NY+1)+(NX+1)*NY+(NX+1)*(NY+1)))+1;
                Bp[kk-1]=EpyA(h-1);//Ep(kk,1)=EpyA(h,fnn);
            }    
        }    
    }
    for(int i=1;i<=NZ;i++)//% Ezp
    {
        for(int j=1;j<=NY+1;j++) 
        {
            for(int k=1;k<=NX+1;k++)
            {
                int kk=(i-1)*((NX+1)*(NY+1)+(NX+1)*NY+(NY+1)*NX)+(NX+1)*NY+(NY+1)*NX+(j-1)*(NX+1)+k;
                int h=floor((kk-1)/(NX*(NY+1)+(NX+1)*NY+(NX+1)*(NY+1)))+1;
                Bp[kk-1]=EpzA(h-1);
            }    
        }    
    }
    //int countEp=0;
    for(int i=1;i<=NL;i++)
    {
        VecSetValue(Ep, i-1, Bp[i-1], INSERT_VALUES);
        //if(curRank==0)
        //if(Bp[i-1].real()!=0.0||Bp[i-1].imag()!=0.0)
        //{
           // printf("Bp[%d]=%e,%e\n",i-1,Bp[i-1].real(),Bp[i-1].imag());
          //  countEp++;
       // }
        
    }   
    //cout<<"countEp="<<countEp<<endl;
    VecAssemblyBegin(Ep); 
    VecAssemblyEnd(Ep);
    //闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐偓锝庝簼閹癸綁鏌ｉ鐐搭棞闁靛棙甯掗～婵嬫晲閸涱剙顥氬┑掳鍊楁慨鐑藉磻閻愮儤鍋嬮柣妯荤湽閳ь兛绶氬鏉戭潩鏉堚敩銏ゆ⒒娴ｈ鍋犻柛搴㈡そ瀹曟粓鏁冮崒姘€悗骞垮劚椤︿即鎮￠悢鍏肩厵闂侇叏绠戦獮妤冪磽瀹ュ棗鐏ラ棁澶嬬節婵犲倹顥㈤柛婵婃缁辨帞绱掑Ο鑲╃杽闂佽鍠曠划娆徫涢崘顭嬪綊鐓幓鎺斾痪缂備胶绮粙鎾寸閿曞倸纾兼慨姗堢到娴滅偓淇婇妶鍛殭闁搞劍绻勭槐鎾存媴婵埈浜、姘舵焼瀹ュ棗鈧灚绻涢幋鐐垫噽闁绘帊绮欓弻娑樜熼崗鍏兼瘓濠殿喖锕ら…宄扮暦閹烘埈娼╂い鎴ｆ娴滈箖鏌熼梻瀵歌窗闁轰礁顑嗛妵鍕箻椤栨稑娈熼梺鎼炲労閸撴岸寮插┑瀣厱閻忕偛澧介妴鎺楁煕濡搫鑸归柍瑙勫灴椤㈡瑩寮妶鍕繑闂備礁鎲￠幐鑽ょ矙閹捐泛鍨濋柡鍌涳紩濞差亶鏁傞柛娑卞灠楠炴劙鏌ｆ惔鈥冲辅闁稿鎹囬幃妤呮晲鎼粹€愁潾閻炴熬绠撳缁樻媴缁涘娈愰梺鍝ュУ鐢€愁嚕閺屻儲鍋愰柤濮愬€曠粊锕傛⒑鐟欏嫬绀冩い鏇嗗懐涓嶉柟鎯板Г閻撴盯鏌涚仦鐐殤濞寸姰鍨荤槐鎺楊敃閵忊懣锝囩磼缂佹绠為柟顔荤矙濡啫霉闊彃鍔﹂柡灞稿墲閹峰懘宕ㄦ繝鍌涙畼闂備線鈧稓鈹掗柛鏃€鍨块獮鍐ㄢ堪閸曨剙寮块梺纭呭焽閸斿本绂嶆ィ鍐╃厱鐎光偓閳ь剟宕戦悙纰樺亾閻㈤潧孝妞ゎ厼娼″畷妤佸緞鐎ｎ偆褰ｇ紓鍌氬€哥粔宕囩矆娓氣偓閹箖鎮滈挊澹┾晠鏌嶆潪鎷屽厡濡ょ姴娲娲偡闁箑娈舵繝娈垮灠椤曨厼危閹扮増鐒肩€广儱妫岄幏缁樼箾閹炬潙鐒归柛瀣崌閺屽秷顧侀柛鎾寸洴瀹曟垵鈽夐姀鈥虫濡炪倖鐗楃粙鎺戔枍閻樼粯鐓欑紓浣靛灩閺嬬喖鏌ｉ幘瀵告创闁诡喗锕㈤幃娆撳箵閹哄棙瀵栭梻渚€娼уΛ娆戞暜閿熺姴钃熺€广儱鐗滃銊╂⒑閸涘﹥灏柛鏂挎捣濡叉劙鎮欓崫鍕€垮┑鐐村灦椤洭鏁嶅☉銏♀拺闁告稑锕ｇ欢閬嶆煕濮椻偓缁犳牕顕ｉ幎鑺ユ櫆闂佹鍨版禍楣冩煕韫囨搩妲稿ù婊堢畺濮婃椽宕ㄦ繝鍐槱闂佸憡鎸婚惄顖氱暦閵忋倕绠瑰ù锝囨嚀閳ь剛鏁婚弻娑滅疀閹垮啯笑婵炲瓨绮撶粻鏍蓟閿濆棙鍎熸い鏍ㄧ矌鏍￠梻浣告啞閹稿鎯勯鐐叉瀬鐎广儱顦伴崑鍕煕濠靛嫬鍔ゆい鏃€娲熼弻锝嗘償閿濆棙姣勯柡瀣典簼閵囧嫭鎯旈姀鈥崇闂佸疇顫夐崹鍧楀垂妤ｅ啯鎯炴い鎰╁灪閻忓孩淇婇妶鍥ラ柛瀣〒閹广垹顫滈埀顒勭嵁閸愵喖鐓涢柛鎰ㄦ櫅閻濅即姊洪懖鈹炬嫛闁告搫绠撳畷顒佺鐎ｎ偀鎷绘繛杈剧到閹诧紕鎷归敓鐘崇厱閹煎瓨绋戦埀顒佺箓閻ｅ嘲煤椤忓嫰鍞跺┑鐘茬仛閸旀宕濋悜鑺モ拺闂傚牊渚楀Σ鍫曟煕鎼搭喖娅嶇€殿喓鍔嶇粋鎺斺偓锝庡亞閸欏棗鈹戦悙鏉戠仸闁挎碍銇勮箛濠冩珔闂囧绻濇繝鍌氭殧闁稿鍨介弻锛勪沪閸撗€濮囩紓浣虹帛缁诲牆鐣峰鈧、鏃堝礋閵婏箑鐝遍梻鍌氬€峰ù鍥ь浖閵娧勵偨闁跨喓濮寸粣妤呮煛瀹ュ骸澧板ù婊勭懇濮婄粯鎷呴崨濠傛殘闂佸憡姊归崹鍨暦濠靛棛鏆嗛柛鏇ㄥ墮閳ь剝娉涢埞鎴︽偐閸欏顦╅梺缁樻尰閻熲晠寮婚妶鍚ゅ湱鈧綆鍋呴悵妤呮煢濡厧鏋庨柍瑙勫灴閺佸秹宕熼銈呯稇闂備胶枪缁绘垿骞忓┑鍫㈢濞达絽鎽滈弳锕€鈹戦崒婧撶懓鏁梻浣瑰濮婂綊宕曢幎鐣屽祦婵°倕鎳忛埛鎺戙€掑锝呬壕濠电偘鍖犻崨顔煎簥闂佸湱鍎ら幐濠氬矗韫囨稒鐓欑紓浣靛灩閺嗗顭跨捄鐑樻崳闁汇倐鍋撴繝鐢靛仦閸ㄥ爼鎮疯瀹曘垽宕ㄦ繝鍕啎闁哄鐗嗘晶鐣岀矓椤旂晫绠鹃柣鎾冲瘨閻撳ジ鏌ｉ幙鍐ㄥ⒋妞ゃ垺顨婂畷鐔碱敆閸屾艾绠ュ┑锛勫亼閸婃牕顫忔繝姘偍鐟滃秴宓勬繝鐢靛У绾板秹鎮￠崘顔藉仯闁搞儯鍔庨崣鈧銈呭椤ㄥ﹪寮诲鍥ㄥ珰闁哄被鍎卞鏉课旈悩闈涗粶妞ゆ垵鎳橀崺鐐哄箣閿曗偓楠炪垺绻涢崱妤冪缂佹鎸荤换婵嬫偨闂堟刀銉╂煛娴ｈ鍊愮€规洘鍨甸埥澶愬閳ュ厖妲愰梻渚€娼ц噹闁告劑鍔庢禍浼存⒒娴ｇ瓔娼愰柛搴ゆ珪閺呰埖鎯旈姀鈶╂灃閻庡箍鍎遍ˇ浼存偂濞戞埃鍋撻獮鍨姎濡ょ姵鎮傞悰顕€寮介鐔哄弮闂佸憡鍔︽禍婊堝几濞戙垺鐓涢悘鐐靛亾缁€鍐磼缂佹娲撮柟顔界懇椤㈡鎷呴崫鍕ɑ闂傚倸鍊烽懗鑸电仚濡炪倖鍨甸幊搴ょ亱濠电娀娼ч鍛存嫅閻斿摜绠鹃柟瀵稿仧閻擃垱绻涘畝濠侀偗闁哄本鐩獮妯侯渻鐠囪弓澹曟繝纰樺墲瑜板啴鎮ч崱娑掆偓鏃堝礃椤斿槈褔鏌涘☉姗嗗殶鐎规洦浜娲偡閺夋寧顔€闂佺懓鍤栭幏锟�
   /* PetscScalar *bufA1;
    PetscInt sizeEp;
    VecGetLocalSize(Ep,&sizeEp);
    VecGetArray(Ep, &bufA1);
    int countEp=0;
    //if(rank>=70&&rank<=80)
    {
        for(int i=0;i<sizeEp;i++)
        {
            if(bufA1[i].real()!=0.0||bufA1[i].imag()!=0.0)
            {
                printf( "Ep,i=%d=(%e,%e)\n",i,bufA1[i].real(),bufA1[i].imag());
                countEp++;
            }
                
        }
            
    }
    cout<<"coutEp="<<countEp<<endl;
    VecRestoreArray(Ep, &bufA1);*/
    MatAXPY(copyK3, 1, v0A.K4, UNKNOWN_NONZERO_PATTERN); //闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鐐劤缂嶅﹪寮婚敐澶婄闁挎繂鎲涢幘缁樼厱濠电姴鍊归崑銉╂煛鐏炶濮傜€殿喗娼欒灃闁逞屽墯缁傚秹骞嗚濞撳鏌曢崼婵堝嚬缂併劌顭烽弻娑㈡偄閸涘﹦绋囬梺浼欑秮椤ユ挾鍒掑▎鎴炲珰闁绘劦鍓氶ˉ鍫ユ煕閳规儳浜炬俊鐐€栫敮鎺斺偓姘煎墰婢规洘绺介崨濠勫帾婵犵數鍋熼崑鎾斥枍閸℃稒鐓熼柟鎯ь嚟閹冲洦鎱ㄦ繝鍌ょ吋鐎规洘甯掗～婵嬫偂鎼淬埄鍟€濠碉紕鍋戦崐褏鎷嬮敐鍥╀笉闁规崘顕ч拑鐔兼煥濠靛棭妲搁崶瀛樼節閵忥絾纭鹃柣顒€銈稿鎶筋敃閿旇В鎷洪梺鍛婄箓鐎氼噣鎮炵捄銊х＜闁圭粯宸婚崑鎾绘偄鏉炴媽鍩呴梻鍌氬€风粈渚€骞夐敍鍕床闁稿本澹曢崑鎾愁潩閻撳骸绫嶉柦妯煎枑缁绘繈妫冨☉鍗炲壉闂佹娊鏀遍崹鍦閹惧瓨濯撮柤娴嬪墲閸ㄥ潡宕哄☉銏犵婵°倓鑳堕崢鍗炩攽閳藉棗鐏ｅ┑顔芥綑鐓ら柨鏇炲€哥壕褰掓煕瑜庨〃鍡涙偂閺囩喆浜滄い鎾跺枎閻忋儱霉濠婂嫮澧棁澶嬬節婵犲倸顏柣顓熷浮閺屸€崇暆閳ь剟宕伴弽顓炵畺婵犲﹤鍚橀悢鍏兼優闂侇偅绋掑Ο濠傗攽閿涘嫬浜奸柛濠冩礀闇夋慨姗嗗幘椤╁弶銇勮箛鎾跺闁藉啰鍠栭弻銊モ攽閸♀晜笑缂備胶濮撮…鐑藉箖濡も偓閳藉鈻庡Ο鐓庡Ш婵＄偑鍊х紓姘跺础閸愬樊娼栨繛宸簻娴肩娀鏌涢弴銊ュ箻闁告柨婀辩槐鎾存媴閾忕懓绗＄紓浣筋嚙閸婂潡骞冮幆褏鏆嬮梺顓ㄩ檮瀵ゆ椽姊洪柅鐐茶嫰婢ь垰菐閸パ嶈含妤犵偞鐗楅幏鍛存嚃濠靛嫬濮傞柡灞炬礉缁犳盯寮撮悙鎰ㄢ偓鎰佺唵閻熸瑥瀚粈瀣叏婵犲啯銇濈€规洏鍔嶇换婵嬪礋閵婏富娼旈梻鍌欑劍鐎笛兠洪埡鍛挃闁告洦鍨伴悿楣冩煕椤愶絾绀冮柡鍜佸墴閺屾盯寮撮妸銉ョ闂佹寧绋掔换鍫濐潖閾忓湱鐭欓柟绋垮閹烽亶姊洪懡銈呮瀭闁告梹鍨甸悾宄拔旈埀顒勬偩濠靛绀嬫い鎺戝€稿浼存⒒婵犲骸浜滄繛璇х畵楠炴垿宕堕鈧惌妤呮煕閺囥劌骞愰柛瀣尵閹叉挳宕熼鍌︾喘闂備焦鎮堕崝宥咁渻閼恒儰绻嗛柛顐ｆ礃閺呮彃顭跨捄鐚村姛妞わ负鍔戝娲箰鎼达絿鐣甸梺绋匡工閹诧紕绮嬪鍡愬亝闁告劏鏅濋崢鎼佹⒑閸涘﹤濮傞柛鏂垮閺呰泛鈽夐姀锛勫幐闂佸憡渚楅崰妤呭磹閹扮増鐓涢悘鐐额嚙婵倿鏌熼鍝勨偓婵嗙暦閹烘垟妲堟慨妤€妫旂槐锟�3=K3+K4
    MatMult(copyK3, Ep, P);// 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鐐劤缂嶅﹪寮婚敐澶婄闁挎繂鎲涢幘缁樼厱濠电姴鍊归崑銉╂煛鐏炶濮傜€殿喗娼欒灃闁逞屽墯缁傚秹骞嗚濞撳鏌曢崼婵堝嚬缂併劌顭烽弻娑㈡偄閸涘﹦绋囬梺浼欑秮椤ユ挾鍒掑▎鎴炲珰闁绘劦鍓氶ˉ鍫ユ煕閳规儳浜炬俊鐐€栫敮鎺斺偓姘煎墰婢规洘绺介崨濠勫帾婵犵數鍋熼崑鎾斥枍閸℃稒鐓熼柟鎯ь嚟閹冲洦鎱ㄦ繝鍌ょ吋鐎规洘甯掗～婵嬫偂鎼淬埄鍟€濠碉紕鍋戦崐褏鎷嬮敐鍥╀笉闁规崘顕ч拑鐔兼煥濠靛棭妲搁崶瀛樼節閵忥絾纭鹃柣顒€銈稿鎶筋敃閿旇В鎷洪梺鍛婄箓鐎氼噣鎮炵捄銊х＜闁圭粯宸婚崑鎾绘偄鏉炴媽鍩呴梻鍌氬€风粈渚€骞夐敍鍕床闁稿本澹曢崑鎾愁潩閻撳骸绫嶉柦妯煎枑缁绘繈妫冨☉鍗炲壉闂佹娊鏀遍崹鍦閹惧瓨濯撮柤娴嬪墲閸ㄥ潡宕哄☉銏犵婵°倓鑳堕崢鍗炩攽閳藉棗鐏ｅ┑顔芥綑鐓ら柨鏇炲€哥壕褰掓煕瑜庨〃鍡涙偂閺囩喆浜滄い鎾跺枎閻忋儱霉濠婂嫮澧棁澶嬬節婵犲倸顏柣顓熷浮閺屸€崇暆閳ь剟宕伴弽褏鏆︽い鎰剁畱缁€瀣亜閹烘埈妲规い銉到閳规垿鎮欓懠顒佹喖缂備緡鍠楅幐鍓у垝婵犳艾鍐€鐟滄粌顭囬弽顓熺叄闊洦鎸哥敮銊╂煕鐎ｎ偅宕岀€规洜鍏橀、姗€鎮欓幇鍓佺ɑ闁靛洤瀚版俊鐑藉Ψ椤斿彨褔姊洪棃娑欐悙閻庢矮鍗冲顐﹀礃椤旇偐锛滃┑鐐村灦閻熲晠寮鍛箚闁绘劦浜滈埀顒佺墪鐓ら柍鍝勫暟缁€濠傘€掑锝呬壕闂侀潧妫旂粈渚€锝炲┑鍫熷磯闁惧繒鎳撴慨锔戒繆閻愵亜鈧牜鏁幒鏂哄亾濮樼厧澧寸€殿喕鍗虫俊鐑藉煛閸屾粌甯楅柣鐔哥矋缁挸鐣峰⿰鍐炬僵閻犺桨缍嶉敃鍌涚厱闁哄洢鍔岄悘鐘电磼閻樺啿鈻曢柡宀€鍠撻埀顒佺⊕椤洨绮婚妷銉冨綊鎮╅懡銈囨毇濠殿喖锕ュ钘夌暦椤愶箑绀嬫い鎺嗗亾妞ゅ孩绋掔换娑氣偓娑欘焽閻倕霉濠婂嫮鐭掗柨婵堝仩缁犳盯寮撮悩纰夌床婵犵妲呴崹鐢割敋瑜旈、鎾诲箻閸撲胶锛濇繛杈剧到濠€閬嶅煡婢跺浜滈柟瀛樼箖閸ｅ綊鏌嶇紒妯诲磳妤犵偛娲幃褔宕煎顓烆伖闂傚倷绀侀幉锛勭紦閸ф纾块弶鍫涘妿婢р€斥攽閿涘嫬浜奸柛濠冨灴瀹曟繂鐣濋崟顒€浜遍梺瑙勫劤绾绢參寮抽敂鑺ュ弿婵☆垱瀵х涵鍓х磼閻樼儤鐝ǎ鍥э躬婵″爼宕掑顐㈩棜缂傚倸鍊烽懗鑸垫叏閹绢喒鈧箓鎮滈挊澶岀暫閻熸粎澧楃敮鎺楁倷婵犲啨浜滈煫鍥ㄦ尭椤忣剟鏌℃担鍛婂仴婵﹨娅ｅ☉鐢稿川椤撳鎸荤换娑㈡嚑椤掆偓閺嬫稒顨ラ悙鎻掓殭閾绘牠鏌涘☉鍗炲箻妞は佸嫮绡€闁靛骏绲剧涵楣冩煥閺囶亞绋荤紒鏃傚枛瀵挳濮€閳锯偓閹风粯绻涙潏鍓у埌闁硅绻濆畷顖炴倷鐎靛摜顔曢柣鐘叉厂閸涱垱娈奸柣搴ゎ潐濞叉鍒掑畝鍕剁稏婵犻潧顑愰弫鍕煠閹帒鍔ら柍褜鍓氬钘夘潖濞差亝顥堟繛鎴炴皑閻ゅ嫰姊虹粙鍖℃敾闁绘濞€瀹曞搫鈽夐姀鐘殿吅闂佹寧妫佸Λ鍕椤栫偞鈷戦悹鍥ｂ偓鍐茬闁汇埄鍨辩敮妤佺┍婵犲洤绀傞柤娴嬫櫇椤旀洟姊洪崨濠佺繁闁哥姵鐗楅幈銊ヮ吋婢跺鍘搁悗鍏夊亾闁逞屽墴瀹曚即寮借閺嗭附绻涢崱妯诲碍閸ユ挳姊虹化鏇炲⒉妞ゃ劌绻戠€靛ジ鏁撻敓锟�//P=(K3+K4)*Ep;  
   /* PetscScalar *bufA1;
    PetscInt sizeP;
    VecGetLocalSize(P,&sizeP);
    VecGetArray(P, &bufA1);
    int countP=0;
    //if(rank>=70&&rank<=80)
    {
        for(int i=0;i<sizeP;i++)
        {
            if(bufA1[i].real()!=0.0||bufA1[i].imag()!=0.0)
            {
                printf( "P,i=%d=(%e,%e)\n",i,bufA1[i].real(),bufA1[i].imag());
                countP++;
            }
                
        }
            
    }
    cout<<"coutEp="<<countP<<endl;
    VecRestoreArray(P, &bufA1);*/
    
   // PetscPrintf(PETSC_COMM_WORLD, "P=(K3+K4)*Ep闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳婀遍埀顒傛嚀鐎氼參宕崇壕瀣ㄤ汗闁圭儤鍨归崐鐐差渻閵堝棗绗掓い锔垮嵆瀵煡顢旈崼鐔蜂画濠电姴锕ら崯鐗堟櫏婵犵數濮崑鎾炽€掑锝呬壕濠殿喖锕ㄥ▍锝囨閹烘嚦鐔兼惞闁稓绀冨┑鐘殿暯濡插懘宕戦崟顓涘亾濮樼厧鏋ら柛鎺撳笚缁绘繂顫濋鐐版睏缂傚倸鍊烽悞锕傗€﹂崶顒€鍌ㄩ柣銏犳啞閳锋垹鐥鐐村婵炲吋鍔欓弻娑㈠籍閹惧墎鏆ら悗瑙勬礋濞佳囧煝鎼淬劌绠婚柡澶嬪灍閸嬫捇宕归锝呭伎濠殿喗顨呭Λ妤佹櫠缂佹ü绻嗛柟缁樺笧缁夋椽鏌＄仦鐐鐎规洘鍎奸ˇ鍙夈亜韫囷絽骞楁い銊ｅ劦閹瑩寮堕幋鐐剁檨婵°倗濮烽崑娑㈩敄閸涙潙鐓橀柟杈剧畱缁犳稒銇勮箛鎾村櫣濞存粍绻堝濠氬磼濮橆兘鍋撻悜鑺ュ€块柨鏇炲€哥粻鏍煕椤愶絾绀€缂佲偓婢跺备鍋撻崗澶婁壕闂佸憡娲﹂崑鍡涙晬濞嗘挻鍋℃繝濠傛噹椤ｅジ鎮介娑樼缂侇喖顭烽幃娆撴倻濡厧甯惧┑鐘垫暩閸嬫盯鎮樺┑瀣婵°倕鎳忛悡娑㈡煃瑜滈崜姘辩矉閹烘柡鍋撻敐搴′簽闁告﹢浜跺娲濞戣鲸顎嗙紓浣藉蔼婵倖绌辨繝鍥ㄥ€婚柤鎭掑劤閸樻悂鏌ｆ惔顖滅К闁糕晜鐗滈埀顒佺啲閹凤拷");
    
    int idn, idn1, idn2, idn3, idn4, idn5, idn6, idn7;
    int i,j,k;
    int BDN = ((NX+1)*NY+(NY+1)*NY)*2+NZ*(NX+1+NX+1+NY-1+NY-1+NX+NX+NY+NY)-NX-NX-NY-NY;
    Eigen::RowVectorXi Bid(BDN+1);
    Bid.setZero(); 

    idn = 0;
    for(j=1;j<=NY+1;j++)
        for(i=1;i<=NX;i++){
            idn+=1;
            Bid(idn) = (j-1)*(NX+NX+1)+i;
        }

    idn1 = idn;
    PetscPrintf(PETSC_COMM_WORLD, "A Bid(%d)\n", idn1);
    for(k=1;k<=NZ-1;k++){
        for(i=1;i<=NX;i++){
            idn+=1;
            Bid(idn) = k*(NX*(NY+1)+(NX+1)*NY+(NX+1)*(NY+1))+i;
        }
        for(i=1;i<=NX;i++){
            idn+=1;
            Bid(idn)= k*(NX*(NY+1)+(NX+1)*NY+(NX+1)*(NY+1))+NY*(NX+1)+NX*NY+i;
        }
    }

    idn2 = idn;
    PetscPrintf(PETSC_COMM_WORLD, "A Bid(%d)\n", idn2);
    for(j=1;j<=NY+1;j++)
        for(i=1;i<=NX;i++){
            idn+=1;
            Bid(idn) = NZ*(NX*(NY+1)+(NX+1)*NY+(NX+1)*(NY+1))+(j-1)*(NX+NX+1)+i;
        }

    idn3 = idn;
    PetscPrintf(PETSC_COMM_WORLD, "A Bid(%d)\n", idn3);
    for(j=1;j<=NY;j++)
        for(i=1;i<=NX+1;i++){
            idn+=1;
            Bid(idn) = (j-1)*(NX+NX+1)+NX+i;
        }

    idn4 = idn;
    PetscPrintf(PETSC_COMM_WORLD, "A Bid(%d)\n", idn4);
    for(k=1;k<=NZ-1;k++)
        for(j=1;j<=NY;j++){
            idn+=1;
            Bid(idn) = k*(NX*(NY+1)+(NX+1)*NY+(NX+1)*(NY+1))+(j-1)*(NX+NX+1)+NX+1;

            idn+=1;
            Bid(idn) = k*(NX*(NY+1)+(NX+1)*NY+(NX+1)*(NY+1))+(j-1)*(NX+NX+1)+NX+NX+1;
        }
    
    idn5 = idn;
    PetscPrintf(PETSC_COMM_WORLD, "A Bid(%d)\n", idn5);
    for(j=1;j<=NY;j++)
        for(i=1;i<=NX+1;i++){
            idn+=1;
            Bid(idn) = NZ*(NX*(NY+1)+(NX+1)*NY+(NX+1)*(NY+1))+(j-1)*(NX+NX+1)+NX+i;
        }

    idn6 = idn;
    PetscPrintf(PETSC_COMM_WORLD, "A Bid(%d)\n", idn6);
    for(k=1;k<=NZ;k++){
        for(j=1;j<=1;j++){
            for(i=1;i<=NX+1;i++){
                idn+=1;
                Bid(idn) = (k-1)*((NY+1)*NX+(NX+1)*NY+(NX+1)*(NY+1))+(NY+1)*NX+(NX+1)*NY+i;
            }
        }

        for(j=2;j<=NY;j++){
            idn+=1;
            Bid(idn) = (k-1)*((NY+1)*NX+(NX+1)*NY+(NX+1)*(NY+1))+(NY+1)*NX+(NX+1)*NY+(j-1)*(NX+1)+1;

            idn+=1;
            Bid(idn) = (k-1)*((NY+1)*NX+(NX+1)*NY+(NX+1)*(NY+1))+(NY+1)*NX+(NX+1)*NY+j*(NX+1);
        }

        for(j=NY+1;j<=NY+1;j++){
            for(i=1;i<=NX+1;i++){
                idn+=1;
                Bid(idn) = (k-1)*((NY+1)*NX+(NX+1)*NY+(NX+1)*(NY+1))+(NY+1)*NX+(NX+1)*NY+(NX+1)*NY+i;
            }
        }
    }
        idn7 = idn;
        PetscPrintf(PETSC_COMM_WORLD, "A Bid(idn7=%d)\n", idn7);
        PetscPrintf(PETSC_COMM_WORLD, "A 2\n");
        
        int slide, st_idx, ed_idx;
        slide = floor((double)idn7 / curSize);
        st_idx = curRank*slide+1;
        if(curRank != curSize-1)
            ed_idx = (curRank+1)*slide;
        else
            ed_idx = idn7;
        for(i=st_idx;i<=ed_idx;i++)
        {   
            VecSetValue(P, Bid(i)-1, myzero, INSERT_VALUES);
        }
        VecAssemblyBegin(P);
        VecAssemblyEnd(P);
        VecDuplicate(P, &Xe); 
        

        PetscLogDouble start_matv1,end_matv1;
        PetscTime(&start_matv1);
        int count_row=0;
        PetscInt row[ed_idx-st_idx+1];
        PetscPrintf(curComm, "ed_idx-st_idx:%d\n",ed_idx-st_idx+1);
        for(int i=st_idx;i<=ed_idx;i++)
        {   

            PetscInt base_i = Bid(i) - 1;
            row[count_row]=base_i;
            count_row++;
            //PetscPrintf(curComm,"i =%d ,base_i=%d\n",i,base_i );
        }     
        MatZeroRowsColumns(v1, count_row, row, 1.0, NULL, NULL);//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鐐劤缂嶅﹪寮婚敐澶婄闁挎繂鎲涢幘缁樼厱闁靛牆鎳庨顓㈡煛鐏炲墽娲存い銏℃礋閺佹劙宕卞▎妯恍氱紓鍌欒兌閸嬫捇宕曢崘宸劷闁跨喓濮撮拑鐔兼煥濠靛棭妲告い顐㈡嚇閺屽秹骞嗛悧鍫€€愬┑鐘亾閺夊牄鍔庨悵鍫曟煛閸モ晛鏋旂紒鈾€鍋撴繝娈垮枟閿曗晠宕㈡ィ鍐ㄥ偍闁汇垹鎲￠埛鎴犵棯椤撶偞濯兼繛鍏煎姍閺屾盯寮幘鍓佹殼閻庤娲熷褔鍩㈡惔銊ョ闁绘顣槐鏌ユ⒒娓氣偓閳ь剛鍋涢懟顖涙櫠椤栨壕鍋撻崹顐ｇ凡閻庢矮鍗抽悰顕€宕堕澶嬫櫍闂佺粯鍔忛弲娑欑妤ｅ啯鐓熼柕蹇曞У閸熺偤鏌ｉ幘鍗炲姕缂佺粯绻堝Λ鍐ㄢ槈濞嗘ɑ锛嗘俊鐐€曠€涒晠銆冮崨绮光偓锕傛嚄椤栵絾歇闁荤喐绮嶅姗€宕幘顔兼槬闁绘劕鎼粻锝夋煥閺冨倻甯涢柡鍛櫊濮婃椽宕烽鈧悷鎳婂綊鎮块妯规睏閻熸粍鏌ㄩ～蹇撁洪鍜佹濠电偞鍨堕悷锕傚箖濞嗘挻鐓熼幖娣灮閻擃垶鏌涘Δ浣糕枙闁诡喕鍗抽、姘跺焵椤掑嫮宓侀柟鐑樺殾閺冨牆鐒垫い鎺戝€绘稉宥夋煥濠靛棙顥犵紒鈾€鍋撻梻鍌氬€搁悧濠勭矙閹达箑姹叉繛鍡楃贩閻熸壋鍫柛顐犲灮閺嗩偊姊洪崫鍕効缂傚秳绶氶悰顔锯偓锝庡枟閺呮煡鏌涘☉妯诲櫤闁圭懓娲璇测槈濞嗘垹鐦堥梺绋挎湰缁牓鎼规惔銊︹拺閻庡湱濯鎰版煕閵娿儲鍋ユ鐐插暣閸╋繝宕ㄩ鐘靛幀濠电姰鍨煎▔娑€偑閺夋嚦锝夋焼瀹ュ棌鎷绘繛杈剧秬濞咃絿鏁☉銏＄厵婵繂鐭堥崵娆撴偂閵堝鐓熼柡鍐ㄥ€哥敮鍫曟煢閸愵亜鏋涢柡灞诲妼閳规垿宕遍埡鍌傦妇绱撴担鍝勑ｇ紒瀣浮婵＄敻宕熼姘鳖唺闂佺懓鐡ㄧ缓楣冨磻閹惧箍浜归柟鐑樺灩閻ゅ懏绻濋棃娑樷偓鎼佸箟閿熺姴鐓曢柟瀵稿Л閸嬫挾鎲撮崟顒傤槬濠电偛鐪伴崝搴ㄥ极椤斿皷妲堥柕蹇ョ磿閸橀潧顪冮妶鍡橆梿妞ゎ偄顦埢宥嗙節閸愨晛寮挎繝鐢靛Т閸嬪棝鎮￠懖鈹惧亾鐟欏嫭绀冮悽顖涘浮閿濈偛鈹戠€ｅ灚鏅為梺鑺ッˇ顔界珶閺囥垺鈷戠紓浣姑悘鍗炩攽椤斿搫鈧繂鐣烽幇鏉块敜婵°倓鑳堕崣鍡涙⒑閸濆嫭宸濋柛瀣洴閸┾偓妞ゆ巻鍋撶紓宥咃工閻ｇ兘寮撮姀鐘殿吅闂佺粯锚閸熷潡寮搁幋锔解拺缂備焦锕╁▓鏃堟煟濡も偓濡稓鍒掗銏犵闁哄啫鍊婚敍婊堟⒑闁偛鑻晶顖溾偓鍨緲鐎氼喗绂掗敂鍓х煓濠㈠墎枪椤ユ岸姊绘担鍛靛湱鎹㈤幇鍏洭顢涘☉姘兼锤婵°倧绲介崯顖炲煕閹达附鈷戞い鎰╁€曟禒婊堟煠濞茶鐏￠柡鍛埣楠炴﹢顢欓悾灞藉箞闂備礁鐤囬～澶愬磿閾忣偆顩查柣鎰靛厸缁诲棝鏌ｉ幇鍏哥盎闁逞屽墯閻楁粓寮鐣岀瘈闁告洦鍘鹃悞鍏肩箾閹炬潙鐒归柛瀣尵閳ь剝顫夊ú婊堝极婵犳哎鈧礁螖閸涱厾顦板銈嗗笒閸婃悂鐛崼銉︹拻濞撴埃鍋撴繛浣冲嫮浠氶梻浣呵圭€涒晜绻涙繝鍌滄殾婵炲樊浜濋弲鏌ユ煕濞戝彉绨奸柡鍌楀亾闂傚倷鑳堕崑銊╁磿鏉堚晛顥氭い鎾卞灩缁犳椽鏌ｅΟ鍏兼毄缁炬儳鍚嬫穱濠囧Χ閸涱厽娈梺鍝勵儐閻╊垶寮诲☉銏犵厴闁诡垎鍌氼棜婵犵绱曢崑鎴﹀磹閺嶎偅鏆滈柟鐑樻煛閸嬫挸顫濋悡搴㈢亪闂佷紮绲介悘姘辩箔閻旂厧鐒垫い鎺戝缁犳牗淇婇妶鍛櫤闁哄懏鐓￠獮鏍垝閻熸澘鈷夐梺璇茬箰缁夌懓顫忛搹鍦煓闁告煭銈呮儓婵＄偑鍊戦崕鏌ュ箲閸ヮ剙绠氶柍褜鍓氶妵鍕疀閹捐泛顤€闂佺ǹ顑呴澶愬蓟濞戙垹鐓涢柛鏇ㄥ墰瑜把囨⒑閹肩偛濡兼繛纭风節閻涱噣宕橀…鎴炲缓闂侀€炲苯澧柣锝呭槻椤粓鍩€椤掍椒绻嗛柟闂寸椤懘鏌嶉埡浣告殲婵犮垺鍨垮濠氬磼濞嗘帒鍘＄紓渚囧櫘閸ㄥ爼寮€ｎ喗鈷戦悹鍥皺缁犺尙鈧厜鍋撶紒瀣儥閸ゆ洟鏌熼幆鐗堫棄闁绘挻绋戦湁闁挎繂鎳庣痪褔鏌￠崒妤€浜炬繝纰夌磿閸嬫垿宕愰弽褜娼栧┑鐘宠壘閻撴洟鏌涢鐘插姎闁告艾缍婇弻锝夊棘閸喗鍊梺缁樻尭閸熶即骞夌粙搴撳牚闁割偅绻勯ˇ顓炩攽椤旇鐟扳枖濞戞氨鐭嗛柛鏇ㄥ幗閸犳劙鏌ｅΔ鈧悧鍡欑箔閹烘鐓熸い鎾跺櫏濞堟粓鏌＄仦鍓ф创妤犵偛娲Λ鍐ㄢ槈濞嗘垳閭紓鍌氬€烽懗鑸垫叏閻㈠憡鍋嬮柣妯款嚙閽冪喖鏌ㄥ┑鍡╂Ц缂佺姵鐩濠氬醇閻旇　妲堝銈庡亽娴滅偟妲愰幘璇茬＜婵ɑ鐦烽姀锛勭鐎瑰壊鍠栧顔锯偓娈垮枛椤嘲顕ｉ幘顔藉亜闁惧繐婀卞Σ鍥⒒婵犲骸浜滄繛璇х畱鐓ゆ繝濠傜墕濮规煡鏌ｅΟ鑲╁笡闁稿﹤鐏氱换娑㈠醇濠靛牅铏庨梺鍝勵儐缁嬫帞鎹㈠☉姘剨闁哄秲鍊曟禍楣冩煙妫颁胶鍔嶇紓宥呴閳规垿鎮欓崣澶嗘灆婵炲瓨绮嶇划搴ｅ垝缂佹ê顕遍柡澶嬪灩椤旀劙鏌℃径濠勫濠⒀傜矙楠炲啯绺介崨濠勫幗闂佹寧绻傚ú锕傚汲椤掍焦鍙忓┑鐘叉噺椤忕姵绻涢幋鐘虫毈鐎规洏鍔戦、娆撳箚瑜庨柨顓㈡⒒閸屾瑧顦﹂柟娴嬧偓鎰佹綎鐟滅増甯囬埀顒€鍟村畷濂稿Ψ閵壯屾Т闂備礁婀遍崕銈夊箰閸撗冨К闁逞屽墮閳规垿顢欓弬銈勭返闂佸憡枪濡嫰鍩㈠鍛牚闁告洦鍘鹃惁鍫ユ⒑闂堟盯鐛滅紒鎻掑⒔濞戠敻鎮欓鍙ョ盎闂佺懓鐡ㄧ换鍌炲焵椤掆偓濞硷繝鎮伴璺ㄧ杸闁瑰彞鐒﹀浠嬨€侀弮鍫濆窛妞ゅ繐鎳庨褰掓⒒閸屾瑧顦﹂柟璇х磿缁瑩骞嬮敂鑺ユ珖闂佹寧娲栭崐鍝ョ不閻樼粯鐓曢柟鑸妽閺夊搫霉濠婂嫮鐭掗柡灞诲姂瀵挳鎮欏ù瀣壕闁绘垼妫勭粻鐔肺旈敐鍛殲闁绘挻鐟﹂妵鍕冀閵婏妇娈ら梺缁樺笒閹诧繝銆冮妷鈺傚€烽柡澶嬪灦鐠囩偤鎮楀▓鍨珮闁告挾鍠庨悾鐑筋敃閿曗偓缁€瀣亜韫囨挸顏存俊顐ｇ矒濮婄粯鎷呴挊澶婃優闂佸摜濮甸崝娆撳箖閻戣棄唯鐟滃宕戦幘鎰佹僵闁绘挸楠哥粻鑽ょ磽娓氬洤鏋涢柣妤佹尭閻ｅ嘲顫滈埀顒勩€佸▎鎾村仼閻忕偠妫勭粻鐐烘⒒閸屾瑧顦﹂柟纰卞亰瀹曨垶鎮╃拠鑼紱闂佺懓澧界划顖炴偂閻斿吋鐓熼柡鍌氱仢缁狙勭箾閸涱叏韬柡宀嬬到閳藉宕￠悙瀵镐憾缂傚倷鑳剁划顖滄崲閸繄鏆﹂柟鐑樺殾閺冣偓閹峰懐鎲撮崟顒傚竼闂傚倸鍊峰ù鍥敋瑜斿畷娆撴偩瀹€鈧粈濠囨煕閳╁啰鈽夌痪鎯ь煼閺屾盯鍩勯崘顏佹缂備讲鍋撳鑸靛姈閻撶喖鏌熸潏鍓у埌鐞氭岸姊洪幎鑺ユ暠闁搞劌娼″濠氭偄閾忓湱鐓撻梺鍓茬厛閸ｎ噣宕濇径宀€纾奸柟顖嗗啠鎸冮梺杞扮椤嘲顕ｇ拠娴嬫婵﹫绲芥禍楣冩煥濠靛棝顎楀ù婊勭箘閳ь剝顫夊ú鏍儗閸岀偛钃熼柍銉ョ－閺嗗棝鎮楅敐搴″闁伙箑鐗撻幃妤冩喆閸曨剙顦╂繛瀛樼矋缁诲牓鐛箛娑樺窛妞ゆ牗绮庨悡鎾绘煟閻樿精顒熼柣鎾崇墦瀹曨垳鈧綆鍓涚壕浠嬫煕鐏炴崘澹橀柍褜鍓欓崲鏌ユ箒闂佹悶鍎崝濠冪閸儲鐓欓梻鍌氼嚟椤︼妇绱掗悩宕囧弨闁哄本鐩俊鐑藉箣濠靛洤娅ゅ┑鐐茬墦缁犳牕顫忓ú顏勬嵍妞ゆ挾鍋涙俊娲⒑缁洘娅呴柣妤€妫濋垾锕傚炊椤掆偓閻撴盯鏌涚仦涔呰偐鑺辨繝姘拺闁荤喓澧楅幆鍫㈢磼婢跺苯鍘寸€规洘顨堟禒锕傛儗椤愩倖鍤€妤楊亙鍗冲畷濂稿閵忊剝鐦掑┑鐘愁問閸犳牠鏁冮敂鎯у灊妞ゆ牜鍋涚粻顖炴煕濞戞瑦缍戠€瑰憡绻傞埞鎴︽偐閹绘帗娈梺鍝勵儐閸ㄧ敻鍩為幋锔藉亹闁归绀侀弲閬嶆⒑闂堚晝绉剁紒韫矙閳ワ箓宕堕宥喰梻浣告啞閻熴儵骞婃惔銊ョ厴闁硅揪闄勯崑鎰版偣閸ュ洤鍟╃槐锝夋⒒娴ｈ櫣甯涙い銊ユ噹铻炴繛鎴炶壘閸ㄦ繂鈹戦悩鍐插毈闁轰礁绉电换婵囩節閸屾凹浠奸梺鍝勵儐閸ㄥ灝顫忛搹鍦＜婵妫欓悾鍫曟⒑缂佹﹩娈旀俊顐ｇ〒閸掓帡顢橀悜鍡樺兊闂佺厧鎽滈弫鎼佸储閹间焦鈷戦柛娑橈梗缁堕亶鏌涢悩鎰佹疁鐎规洘鍔欓獮鍥偋閸垹骞愰梺璇茬箳閸嬬娀顢氳閹便劑宕掗悙瀵稿幍濡炪倖鏌ㄩ幖顐﹀焵椤掍胶绠撻柣锝囧厴楠炴帡骞嬮弮鈧～宥呪攽椤旂瓔娈旀俊顐ｆ⒒濡叉劙鏁撻敓锟�0
        PetscTime(&end_matv1);
        //PetscPrintf(curComm, "MatZeroRowsColumns_V1 time(MPI):%f\n",end_matv1-start_matv1);
        
    //PetscPrintf(curComm, "====闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧湱鈧懓瀚崳纾嬨亹閹烘垹鍊炲銈嗗笒椤︿即寮查鍫熷仭婵犲﹤鍟扮粻濠氭煕閳规儳浜炬俊鐐€栫敮濠囨嚄閸洖鐓濋柟鍓х帛閻撴盯鏌涘☉鍗炵仩闁宠鐗撻弻鏇㈠幢閺囩媭妲梺瀹狀嚙闁帮綁鐛鈧畷姗€骞撻幒鎾存婵犵绱曢崑鎴﹀磹閺嶎厼绠板Δ锝呭暙绾惧鏌ｉ弬鍨倯闁稿锕㈤弻鏇熷緞閸℃ɑ鐝曢梺鎶芥敱閸ㄥ潡寮诲☉銏℃櫆閻犲洦褰冪粻褰掓⒑閸涘﹥鐓ユい鎴濇婵＄敻宕熼姣尖晠鏌曟径娑氱暠婵炲憞鍕瘈闁靛骏缍嗗鎰箾閸欏鐒介柟骞垮灩閳规垿宕遍埡鍌氬厞婵＄偑鍊栭幐鐐叏閹绢喚宓佺€广儱顦伴埛鎺懨归敐鍫燁仩閻㈩垱鐩弻娑㈠籍閹惧墎鏆ら悗瑙勬礃缁矂锝炲┑瀣殝闂傚牊绋堥崑鎾诲醇閺囩啿鎷哄銈嗗坊閸嬫挾绱掓径灞炬毈闁诡喒鈧枼妲堥柕蹇ョ磿閸樻捇鎮峰⿰鍕煉鐎规洘绮撻幃銏ゆ偂鎼达絿鏋冮梻浣虹帛閸旀洟骞栭銏℃殰闂傚倷鐒︾€笛呮崲閸屾壕鍋撳鐓庢珝闁诡垰瀚幆鏃堝Ω閿旇瀚藉┑鐐舵彧缁蹭粙骞夐敓鐘茬畾闁割偁鍎查悡鏇㈡煟閺囨氨顦﹀ù婊勫閳ь剝顫夊ú姗€宕濆▎鎾崇畺闁伙絽鐬奸惌娆撴偣娓氼垳鍘涢柛鐐垫暬濮婄粯鎷呴懞銉с€婇梺鍝ュУ閹稿骞堥妸鈺傚仺闁告稑锕ゆ禍妤呮⒑閸濆嫭鍌ㄩ柛銊ユ贡缁崵鎲撮崟顓狀啎闂佹寧绻傛鍛婃櫠椤曗偓閺岋綀绠涙繝鍐╃彅闂佸疇顫夐崹鍧椼€佸▎鎾村殐闁宠鍎搁崶銊у幐闁诲繒鍋熺涵鍫曞磻閹惧磭鏆﹂柛銉ｅ妽閻ｇ兘姊虹拠鎻掑毐缂傚秴妫濆畷婊冣槈濠ф儳寰嶅┑鐘殿暜缁辨洟宕戦幋锕€纾归柟杈剧畱閸ㄥ倿鏌涘┑鍡楃弸婵炴垯鍨圭粈鍐煏婵炑冨椤旀洟姊绘笟鈧褑澧濋梺鍝勬噳閺呯姴顕ｉ锕€鐐婇柍鍝勫€搁弸鎴︽煙閸忚偐鏆橀柛鎿冨亝瀵板嫮浠︾粙澶稿闂佹寧绻傛鎼佸几閻斿吋鐓冮梺鍨儏缁楁帡妫佹径鎰叆婵犻潧妫欓幖鎰版煕閺傛鍎旈柡灞剧洴婵″爼宕掑顐㈩棜闂傚倷娴囬褏鈧稈鏅犻、娆撳冀椤撶偟鐛ラ梺鍝勭▉閸樹粙宕戞径濞炬斀闁稿本纰嶉幉鍝モ偓瑙勬尫缁舵岸寮婚悢鍏煎亱闁割偆鍠撻崙锛勭磽娴ｅ搫顎岄柛锝忕秮瀵鏁冮埀顒冪亽婵炴挻鍑归崹杈ㄦ櫏闂傚倷娴囬褏鈧灚甯″畷婊堟偄婵傚缍庡┑鐐叉▕娴滄繈宕戦敓鐘崇厸濠㈣泛锕﹀銊╂煙缁嬪灝鏆熺紒杈ㄦ尰缁楃喖宕惰閻濐噣姊洪幖鐐插婵炲鐩、姘舵晲婢跺﹨鎽曢梺闈涱槶閸庢娊顢欓幇顓犵閺夊牆澧介崚鐗堢節閳ь剟鏌嗗鍛厬闂佺硶鍓濈粙鎺楀煕閹寸姷纾藉ù锝堝亗閹寸姷鐭嗛柍褜鍓熷铏圭矙閸栤€充紣濠电姭鍋撻梺顒€绉撮悞鍨亜閹哄秷鍏岄柛鐔哥叀閺岀喖宕欓妶鍡楊伓======\n");
   //闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐偓锝庝簼閹癸綁鏌ｉ鐐搭棞闁靛棙甯掗～婵嬫晲閸涱剙顥氬┑掳鍊楁慨鐑藉磻閻愮儤鍋嬮柣妯荤湽閳ь兛绶氬鏉戭潩鏉堚敩銏ゆ⒒娴ｈ鍋犻柛搴㈡そ瀹曟粓鏁冮崒姘€梺鍛婂姦閸犳鎮￠妷鈺傜厸闁搞儺鐓堝▓鏂棵瑰⿰鍫㈢暫婵﹤鎼晥闁搞儜鈧崑鎾斥攽閸澀绗夐梺鍝勭▉閸樺ジ鎷戦悢琛″亾楠炲灝鍔氭い锔诲灡鐎靛ジ鎮╃紒妯煎幈闂佸搫娲㈤崝灞炬櫠椤旂晫绠鹃柛婊冨暟缁夘喗鎱ㄦ繝鍛仩缂侇喗鐟╅幊妤咁敍閿濆棜鏅ч梻鍌欑閹诧繝寮婚妸褏鐭撻柛顐ｆ礀缁犳煡鏌曡箛鏇炐涙俊鎻掔墛閹便劌螖閳ь剙螞濡ゅ懎鐤鹃柣妯烘▕濞撳鏌曢崼婵囶棡妞ゃ儱妫涢埀顒冾潐濞叉粓寮繝姘畾闁告洦鍓氶崕鐔兼煏婵犲繗鍚傞柟閿嬫そ濮婅櫣绮欑捄銊ь啈闂佺ǹ顑嗛崝娆撶嵁濡ゅ懎绀冮柍鐟般仒缁ㄨ顪冮妶鍡楀闁糕晛瀚灒闁逞屽墯缁绘繄鍠婃径宀€锛熼梺杞版祰椤曆囨偩閻戣姤鍋勭痪鎷岄哺閺咁剙鈹戦鏂よ€跨痪顓熸倐瀹曨剙煤椤忓應鎷绘繛杈剧悼閸庛倝宕甸埀顒勬⒑鐎癸附婢樻俊璺ㄧ磽閸屾稒灏伴柕鍫秮瀹曟﹢濡歌缁遍亶姊绘担绛嬫綈闁稿骸纾划璇差吋閸℃瑯娲搁悷婊呭鐢鎮″▎鎾寸厽闁瑰浼濋鍫熷€堕柍鍝勬噺閻撶喐绻涢幋鐐靛ⅹ闁告棑闄勯幈銊︾節閸涱噮浠╅梺鍛婄墬閻楃姴顕ｉ幘顔藉€锋繛鏉戭儐鐎氱喓绱撻崒姘偓椋庣矆娓氣偓椤㈡牠宕卞▎鎰闂佽法鍠撴慨瀵哥不閺嶎厽鐓ラ柣鏂挎惈瀛濋柛鐑嗗灦濮婃椽骞愭惔銏㈠弳婵犫拃鍌滅煓闁诡垯绶氬畷濂稿Ψ閿旇瀚介梻浣呵归張顒€顫濋妸锔芥珷婵炴垶姘ㄧ壕濂告倵閿濆骸浜滄繛鎼櫍閹稿﹪鎮㈤崫銉х槇婵犵數濮撮崐鎼侇敂閵夈儍鐟扳堪閸曨厾鐓夐梺缁樻惄閸嬪﹤鐣烽懜娈挎Ч閹肩补鈧磭鍘掓繝鐢靛仜閻°劎鍒掗崼銉ョ闁规儼妫勯拑鐔兼煃閵夈儳锛嶉柡鍡楁閹鏁愭惔鈥愁潾閻炴熬绠撳缁樻媴缁涘娈愰梺鍝ュУ閹瑰洤鐣疯ぐ鎺撳癄濠㈣泛鏈▓鎯ь渻閵堝棗濮х紒鐘冲灥閺侇噣鏌ｉ悢鍝ョ煀缂佺粯锚椤曪綁鎳滈悽娈挎祫闁诲函缍嗛崑鈧柟椋庣帛缁绘稒娼忛崜褍鍩岄梺纭咁嚋缁绘繈鐛崱娑橀唶闁靛濡囬崢钘夘渻閵堝棙灏甸柛搴㈠姇鍗辨繛宸簼閻撴瑦顨ラ悙鑼虎闁诲繆鏅犻弻宥囨喆閸曨偆浠奸梺閫炲苯澧剧紓宥呮缁傚秴鈹戦崰顕嗙秮椤㈡宕熼鑺ュ闂傚倷绶￠崑鍡涘磻濞戙垺鍤愭い鏍ㄧ⊕濞呯姵銇勯弽顐沪闁绘挸绻橀弻娑㈠Ψ閹存繂鏋ゅù鐓庡暙铻栭柣姗€娼ф禒锕傛偨椤栥倗绡€闁绘侗鍠氶埀顒婄秵娴滄牠寮ㄦ禒瀣厵闂侇叏缂氱花鑺ヤ繆椤愵偄鐏︽慨濠傤煼瀹曟帒鈻庨幋婵嗩瀴闂備浇顕栭崰鏍偉閻撳海鏆﹂柟鐗堟緲閸楁娊鏌曡箛濠冩珕闁哄懐鍋炵换婵嬪閿濆懐鍘梺鍛婃⒐濞茬喖骞忛幋锔藉亜闁告縿鍎抽鏇㈡⒑閻熸壆鎽犳慨濠傜秺瀹曡櫕瀵肩€涙鍘撻悷婊勭矒瀹曟粓濡歌娑撳秹鏌熼幑鎰惞鐎规挷绶氶幃妤呮晲鎼存繄鎸夐梺琛″亾濞寸姴顑嗛悡鏇熺箾閹存繂鑸归柣蹇曞█閺屾盯濡舵惔鈥斥拫濠殿喖锕ら…宄扮暦閹烘垟鏋庨柟鏉跨仛閳诲﹦绱撻崒娆戠獢缁绢厽鎮傚畷鏉款潩鏉堫煈娼熼梺缁樺姇閹碱偊鎮欐繝鍐︿簻闁瑰搫妫楁禍鍓х磽娴ｅ搫顎岄柛銊ョ埣瀵濡搁埡鍌氫簽闂佺ǹ鏈粙鎴︻敂閿燂拷
   /* KSP ksp_bicg;
    PC pc_bicg;
    KSPCreate(curComm, &ksp_bicg);
    KSPSetType(ksp_bicg, KSPBCGS);
    KSPSetOperators(ksp_bicg, v1, v1);
    PetscInt    its;
    KSPGetPC(ksp_bicg, &pc_bicg);
    PCSetType(pc_bicg, PCJACOBI); 
    //PCFactorSetMatSolverType(pc_bicg, MATSOLVERSUPERLU_DIST);//
    KSPSetTolerances(ksp_bicg,1e-14, PETSC_DEFAULT, PETSC_DEFAULT, 10000);
    KSPSetFromOptions(ksp_bicg);

    PetscPrintf(curComm, "=======kspSolve start======\n");
    KSPSolve(ksp_bicg, P, Xe);
    KSPGetIterationNumber(ksp_bicg, &its);*/

    KSP ksp_bicg;
    PC pc_bicg;
    KSPCreate(curComm, &ksp_bicg);
    KSPSetType(ksp_bicg, KSPPREONLY);
    KSPSetOperators(ksp_bicg, v1, v1);
    KSPGetPC(ksp_bicg, &pc_bicg);
    PCSetType(pc_bicg, PCLU);
    PCFactorSetMatSolverType(pc_bicg, MATSOLVERSUPERLU_DIST);
    PetscPrintf(curComm, "=======kspSolve start======\n");
    KSPSolve(ksp_bicg, P, Xe);
    PetscTime(&endt);
    //闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鎯у⒔閹虫捇鈥旈崘顏佸亾閿濆簼绨奸柟鐧哥秮閺岋綁顢橀悙鎼闂侀潧妫欑敮鎺楋綖濠靛鏅查柛娑卞墮椤ユ岸姊虹拠鍙夊攭妞ゎ偄顦叅闊洦绋戠壕鍧楁煙閹増顥夐柣鎺戠仛閵囧嫰骞掗幋顖氬缂備礁顦遍弫濠氬蓟濞戙垺鍋愮€规洖娲ら埛鍫熺節閵忥綆娼愭繛鑼枎閻ｉ绮欑拠鐐⒐閹峰懘宕崟顐ゎ吋闂傚倸鍊峰ù鍥敋閺嶎厼鍨傞柧蹇ｅ亝濞呯姵淇婇妶鍛劙濠㈣泛顑呯欢鐐烘煙闁箑澧版い鏃€鍔欏娲传閸曞灚效闂佺硶鏅涢敃顏堟偂椤掑嫷鏁嗛柛鏇ㄥ墰閸樻悂鏌ｈ箛鏇炰哗妞ゆ泦鍥х劦妞ゆ帊鑳剁粻鐐搭殽閻愯宸ラ柍瑙勫灩閳ь剨缍嗘禍鐐侯敇閻撳寒娓婚柕鍫濇椤ュ棝鏌涚€ｎ偄濮堥柡鍛埣椤㈡稑顫濋敐鍡樻澑闂備胶绮崝妯间焊濞嗘挸绠洪柣妯兼暩绾惧吋銇勯弮鍥т汗闁诲繗浜槐鎺撴綇閳轰椒娌紓浣虹帛缁诲牆鐣烽幆閭︽▉闂佺濮ゅú鏍煘閹达附鍊烽柡澶嬪灩娴犙囨⒑閹肩偛濡块柟铏崌瀵偊顢欓幋鎺旂畾闂佺粯鍔︽禍婊堝焵椤掍胶澧い顐㈢箲缁绘繂顫濋鈧崑宥夋偡濠婂嫭顥堥柡浣瑰姍閹瑩宕崟顓炲箰闂備礁鎲￠崝锔界閻愮儤鏅繝濠傜墛閳锋垿鎮归崶锝傚亾瀹曞洠鍋撴繝姘厱闁规澘澧庣粙濠氭倵閸偆澧辩紒杈ㄦ崌瀹曟帒鈻庨幋锝囩崶闂備線娼荤紞鍡涘闯閿濆懐鏆︾憸鐗堝笒缁狀噣鏌﹀Ο渚Ш妞ゆ柨顦靛娲濞戞氨顔婃繝娈垮櫘閸欏啫顕ｉ妸锔绢浄閻庯綆鍋嗛崢閬嶆⒑闂堟侗妲堕柛銊ユ惈閳诲秹宕堕浣哄幗闂佹寧娲嶉崑鎾绘煟濡や焦灏い顐㈢箻閹煎綊宕烽鐘靛幆闂備礁婀辨灙閻庢稈鏅犻獮蹇涙焼瀹ュ棌鎷洪梺鍛婄☉閿曘倝鎮樻潏銊ｄ簻妞ゆ劑鍩勫Σ娲煃瑜滈崜娑㈠极閹间礁鍌ㄧ憸鏃堝箖閹€鏀介悗锝庝簽椤︽澘顪冮妶鍡楃伇濠殿喓鍊楅埀顒佽壘閵堢ǹ顫忕紒妯诲闁告稑锕ら弳鍫㈢磽娴ｅ壊鍎愰柛銊ユ健瀵偊宕橀鍢夈劎鎲稿畝鍕€垮┑鐘叉处閻撶喖鏌曡箛鏇炐ｉ柛鐔哄仱閺屽秹鏌ㄧ€ｎ亞浼岄梺鍝勭焿缁犳垼鐏掓繛鎾村嚬閸ㄩ亶鍩㈤幘缁樷拺閺夌偞澹嗛ˇ锔剧棯椤撴粌鐏叉慨濠傤煼瀹曟帒顫濋钘変壕闁归棿绀佺壕褰掓煙闂傚顦︾痪鍓ф嚀椤啰鈧綆浜濋幑锝夋煟椤撶偞顥滈柕鍡樺笒椤繈鏁愰崨顒€顥氬┑掳鍊楁慨鐑藉磻閻愮儤鍋嬮柣妯荤湽閳ь兛绶氬鏉戭潩鏉堚敩銏ゆ⒒娴ｈ鍋犻柛搴㈡そ瀹曟粓鏁冮崒姘€梺鍛婂姦閸犳鎮￠妷鈺傜厸闁搞儺鐓堝▓鏂棵瑰⿰鍫㈢暫婵﹤鎼晥闁搞儜鈧崑鎾斥攽閸澀绗夐梺鍝勭▉閸樺ジ鎷戦悢琛″亾楠炲灝鍔氭い锔诲灡鐎靛ジ鎮╃紒妯煎幈闂佸搫娲㈤崝灞炬櫠椤旂晫绠鹃柛婊冨暟缁夘喗鎱ㄦ繝鍛仩缂侇喗鐟╅幊妤咁敍閿濆棜鏅ч梻鍌欑閹诧繝寮婚妸褏鐭撻柛顐ｆ礀缁犳煡鏌曡箛鏇炐涙俊鎻掔墛閹便劌螖閳ь剙螞濡ゅ懎鐤鹃柣妯烘▕濞撳鏌曢崼婵囶棡妞ゃ儱妫涢埀顒冾潐濞叉粓寮繝姘畾闁告洦鍓氶崕鐔兼煏婵犲繗鍚傞柟閿嬫そ濮婅櫣绮欑捄銊ь啈闂佺ǹ顑嗛崝娆撶嵁濡ゅ懎绀冮柍鐟般仒缁ㄨ顪冮妶鍡楀闁糕晛瀚灒闁逞屽墯缁绘繄鍠婃径宀€锛熼梺杞版祰椤曆囨偩閻戣姤鍋勭痪鎷岄哺閺咁剙鈹戦鏂よ€跨痪顓熸倐瀹曨剙煤椤忓應鎷绘繛杈剧悼閸庛倝宕甸埀顒勬⒑鐎癸附婢樻俊鍧楁煙楠炲灝鐏╂い鎾炽偢瀹曞崬鈻庡Ο鑽ゃ偒婵犲痉鏉库偓褏寰婃禒瀣柈妞ゆ牜鍋涢悡鏇㈡煙鐎电ǹ啸缁炬儳銈搁幃妤呮晲鎼存繄鍑归梺绋款儍閸庢煡濡甸崟顒佸劅闁靛繆鏅滈悾鑲╃磽娴ｄ粙鍝洪悽顖涱殔椤曘儵宕熼鍌滅槇闂佸憡娲﹂崢婊堝Ω閳哄倸鈧灚绻涢崼婵堜虎闁哄闄勯妵鍕即閸℃鎼愰柣鎾偓鎰佺唵闁兼悂娼ф慨鍥ㄣ亜椤愩垺鍤囬柡宀嬬到铻ｉ悹鍥皺缁侀绱撴担椋庤窗闁革綇绲介～蹇曠磼濡偐鎳濋梺閫炲苯澧い顓炴穿椤︽娊鏌ｈ箛鏃傛噰婵﹨娅ｇ划娆撳垂椤曞懎濡峰┑鐘灮閹虫挸螞濠靛绠犻柣鎰摠缂嶅洭鏌曟繛褍鎳愬Σ鍥ㄧ節濞堝灝鏋熼柨鏇楁櫊瀹曘垽骞栨担鍝ヮ唵濠电偛妯婃禍婵嬪煕閹达附鐓曟繛鎴烇公閸旂喓绱掗悩铏磳闁诡喗顨呴～婵嬫偂鎼粹檧鎷梻浣虹《閺備線宕戦幘鎰佹富闁靛牆妫楃粭鍌滅磼閳ь剚绗熼埀顒勫箖濡皷鍋撻悽鐢点€婇柛瀣尵閹叉挳宕熼鍌ゆК闂備胶绮悧鏇㈠触鐎ｎ偆鈹嶅┑鐘插亞濞兼壆鈧厜鍋撳┑鐘插敪閳哄倷绻嗛柕鍫濇搐鍟搁梺绋款儐閻╊垶骞冭楠炴﹢骞囨担鍦▉缂傚倸鍊烽悞锕傗€﹂崶顒佸仭鐟滅増甯楅悡鍐喐濠婂牆绀堟繛鍡樻尨閳ь剨绠撳畷鍫曨敂瀹ュ棌鏋岄梻鍌欐祰濡椼劎绮堟担铏圭煋濡炲娴锋稉宥嗙箾閹寸們姘ｉ崼鐔剁箚妞ゆ牗澹曢幏鈩冧繆闊厼宓嗘慨濠勭帛閹峰懘宕ㄦ繝鍌涙畼闂備礁鎲″Λ鎴︽⒔閸曨厾鐭夌€广儱鎳夐崼顏堟煕閺囥劌寮炬繛鏉戝濮婄粯绗熼崶褍顫╃紓浣割槺閺佸骞冮垾鏂ユ闁靛繆鈧枼鍋撻崼鏇熺厽闁归偊鍓涙禒娑欑箾閸涱喗绀嬬€规洦鍨崇划娆忊枎閻愵剙鐦滈梻渚€娼уú銈呯暦椤掑嫬纾归柤濮愬€楅悳濠氭煛閸愩劎澧涢柣鎾寸洴閹﹢鎮欓幓鎺嗘寖濠电偞褰冮悺銊┿€冮妷鈺傚€烽弶鍫熷礃閳ь剝娉曢埀顒冾潐濞测晝鎹㈠┑瀣畺婵炲棗娴氶崯鍛亜閺冨倹娅曠紒澶婄仛缁绘繂顕ラ柨瀣凡闁逞屽墯椤ㄥ棝骞堥妸鈺傚€婚柦妯侯槺閿涙稑鈹戦悙鏉戠仸缁炬澘绉撮悾鐑藉矗婢跺寮垮┑锛勫仩椤曆勭妤ｅ啯鍊垫繛鍫濈仢濞呮﹢鏌涚€ｎ亷韬柣娑卞枛铻ｉ柤娴嬫櫇閿涙粌鈹戦埥鍡楃仯缂侇噮鍨堕、鏃堟偄閸忓皷鎷绘繛杈剧秬婵倗娑甸崼鏇熺厱闁挎繂绻掗悾鍨殽閻愯尙绠婚柡浣规崌閺佹捇鏁撻敓锟�
    KSPConvergedReason reason;
    KSPGetConvergedReason(ksp_bicg, &reason);
    if (reason == KSP_DIVERGED_INDEFINITE_PC) {
        PetscPrintf(PETSC_COMM_WORLD, "\nDivergence because of indefinite preconditioner;\n");
        PetscPrintf(PETSC_COMM_WORLD, "Run the executable again but with -pc_factor_shift_positive_definite option.\n");
    } else if (reason < 0) {
        PetscPrintf(PETSC_COMM_WORLD, "\nOther kind of divergence: this should not happen.-->%d\n",reason);
    } else{
        PetscPrintf(PETSC_COMM_WORLD, "\nOther  not happen.\n");
    }
    PetscTime(&endt);
    PetscPrintf(curComm, "V1+P solve time(MPI):%f \n",endt-start);
    VecAXPY(Xe,1,Ep);//X1(:)=X1(:)+Ep;
    
    PetscScalar *bufA;
    PetscInt Xe_s;
    VecGetArray(Xe, &bufA);
    VecGetLocalSize(Xe,&Xe_s);
    //int *recv_curSize=new int[curSize];
    int recv_curSize[curSize]={0};
    //complex<double> *bufVal=new complex<double>[NL];
    //vector<complex<double>> bufVal(NL);
    complex<double> bufVal[NL]={myzero};
    int displs[curSize]={0};


    MPI_Gather(&Xe_s,1,MPIU_INT,recv_curSize,1,MPIU_INT,0,curComm);
    if(!curRank)
    {
        displs[0]=0;
        for(int i=1;i<curSize;i++)
        {
             displs[i]=displs[i-1]+recv_curSize[i-1];
        }
    }
     //
    MPI_Gatherv(bufA,Xe_s,MPIU_SCALAR,bufVal,recv_curSize,displs,MPIU_SCALAR,0,curComm);
   //delete[] recv_curSize;
    //if(curRank==0)
        //PetscPrintf(PETSC_COMM_SELF, "curRank=%d Xe=(%e,%e)  curSize=%d\n",curRank,bufVal[1].real(),bufVal[1].imag(),Xe_s);
    VecRestoreArray(Xe, &bufA);
    if(curRank==0)
    {
        int countbuf=0;
        //for(int i=0; i<NL; i++)
        {
            //if(bufVal[i].real()!=0.0||bufVal[i].imag()!=0)
            {
               // printf("bufVal[%d]=(%e,%e)\n",i,bufVal[i].real(),bufVal[i].imag());
               // countbuf++;
            }
                
        }
        cout<<"countbuf="<<countbuf<<endl;
        //%%%%%%%%%%%%%%  Ex  %%%%%%%%%%%%%%% Ex1=zeros(NX,NY+1,NZ+1);
        vector<vector<vector<complex<double>>>> Ex1(NX,vector<vector<complex<double>>>(NY+1,vector<complex<double>>(NZ+1)));
        //Ey1=zeros(NX+1,NY,NZ+1);
        vector<vector<vector<complex<double>>>> Ey1(NX+1,vector<vector<complex<double>>>(NY,vector<complex<double>>(NZ+1)));
        //Ez1=zeros(NX+1,NY+1,NZ);
        vector<vector<vector<complex<double>>>> Ez1(NX+1,vector<vector<complex<double>>>(NY+1,vector<complex<double>>(NZ)));
        //printf("vector<vector<vector<complex<double>>>> Ez1\n");
        for(int k=1;k<=NZ+1;k++) 
        {
            for(int j=1;j<=NY+1;j++)
            {
                for(int i=1;i<=NX;i++) 
                {
                    int MEij=(k-1)*(NX*(NY+1)+NY*(NX+1)+(NX+1)*(NY+1))+(j-1)*(2*NX+1)+i;
                    Ex1[i-1][j-1][k-1]=bufVal[MEij-1];
                    //printf("MEij=%d \n",MEij);
                }
            }      
        }     
       // printf("Ex1\n");
        for(int i=1;i<=NX;i++) 
        {
            for(int j=1;j<=NY;j++)
            {
              //Exx1[i-1][j-1]=((Ex1(i,j+1,Nair+NN+1)+Ex1(i,j,Nair+NN+1))/2.d0+(Ex1(i,j+1,Nair+NN+2)+Ex1(i,j,Nair+NN+2))/2.d0)/2.d0;
                Exx1[i-1][j-1]=((Ex1[i-1][j][Nair+NN]+Ex1[i-1][j-1][Nair+NN])/2.0+(Ex1[i-1][j][Nair+NN+1]+Ex1[i-1][j-1][Nair+NN+1])/2.0)/2.0;

               // printf("Exx1(%d,%d)=%e,%e\n",i,j,Exx1[i-1][j-1].real(),Exx1[i-1][j-1].imag());
            }
        }
        // %%%%%%%%% Ey %%%%%%%%%%%%%
        for(int k=1;k<=NZ+1;k++) 
        {
            for(int i=1;i<=NX+1;i++)
            {
                for(int j=1;j<=NY;j++) 
                {
                    int MEij=(k-1)*(NX*(NY+1)+NY*(NX+1)+(NX+1)*(NY+1))+(j-1)*(2*NX+1)+NX+i;
                    Ey1[i-1][j-1][k-1]=bufVal[MEij-1];
                }
            }      
        }
        //printf("Eyy1\n");
        for(int i=1;i<=NX;i++) 
        {
            for(int j=1;j<=NY;j++)
            {
              //Eyy1(i,j)=((Ey1(i,j,Nair+NN+1)+Ey1(i+1,j,Nair+NN+1))/2.d0+(Ey1(i,j,Nair+NN+2)+Ey1(i+1,j,Nair+NN+2))/2.d0)/2.d0;
                Eyy1[i-1][j-1]=((Ey1[i-1][j-1][Nair+NN]+Ey1[i][j-1][Nair+NN])/2.0+(Ey1[i-1][j-1][Nair+NN+1]+Ey1[i][j-1][Nair+NN+1])/2.0)/2.0;
                //printf("Eyy1(%d,%d)=%e,%e\n",i,j,Eyy1[i-1][j-1].real(),Eyy1[i-1][j-1].imag());
            }
        }
        //printf("Ez\n");
        //%%%%%%%%% Ez %%%%%%%%%%%%%
        for(int k=1;k<=NZ;k++) 
        {
            for(int i=1;i<=NX+1;i++)
            {
                for(int j=1;j<=NY+1;j++) 
                {
                    int MEij=(k-1)*(NX*(NY+1)+NY*(NX+1)+(NX+1)*(NY+1))+NX*(NY+1)+NY*(NX+1)+(j-1)*(NX+1)+i;
                    Ez1[i-1][j-1][k-1]=bufVal[MEij-1];
                }
            }      
        }
       // printf("Ezz1\n");
        for(int i=1;i<=NX;i++) 
        {
            for(int j=1;j<=NY;j++)
            {
              //Ezz1(i,j)=((Ez1(i,j,Nair+NN+1)+Ez1(i,j+1,Nair+NN+1))/2.d0+(Ez1(i+1,j,Nair+NN+1)+Ez1(i+1,j+1,Nair+NN+1))/2.d0)/2.d0;
                Ezz1[i-1][j-1]=((Ez1[i-1][j-1][Nair+NN]+Ez1[i-1][j][Nair+NN])/2.0+(Ez1[i][j-1][Nair+NN]+Ez1[i][j][Nair+NN])/2.0)/2.0;
                //printf("Ezz1(%d,%d)=%e,%e\n",i,j,Ezz1[i-1][j-1].real(),Ezz1[i-1][j-1].imag());
            }
        }
        //printf("Exz Ezx 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌涘☉姗堟敾闁告瑥绻橀弻锝夊箣閿濆棭妫勯梺鍝勵儎缁舵岸寮婚悢鍏尖拻閻庨潧澹婂Σ顔剧磼閻愵剙鍔ゆい顓犲厴瀵鏁愭径濠勭杸濡炪倖甯婇悞锕傚磿閹剧粯鈷戦柟鑲╁仜婵″ジ鏌涙繝鍌涘仴鐎殿喛顕ч埥澶愬閳哄倹娅囬梻浣瑰缁诲倸螞濞戔懞鍥Ψ瑜忕壕钘壝归敐鍛儓鐏忓繘姊洪崨濠庢畷濠电偛锕ら锝嗙節濮橆厼浜滈梺鎯х箰濠€閬嶆晬濠婂牊鈷戦梻鍫熺〒缁犲啿鈹戦鐐毈闁诡喗锕㈠畷濂稿閵忣澁绱查梻浣虹帛閸旓箓宕滃▎鎾崇闁靛牆妫庢禍婊勩亜閹捐泛孝闁告ê顕埀顒侇問閸犳牠鈥﹂悜钘夌畺闁靛繈鍊栭崑鍌炲箹鏉堝墽绉垫俊鎻掔埣閺岋綁鎮㈤崫銉х厐缂備胶绮敮鈥愁嚕椤愶富鏁婇悘蹇旂墬椤秹姊洪棃娑㈢崪缂佽鲸娲熷畷銏ゅ箻缂佹ǚ鎷绘繛杈剧到閹芥粍绂掗姀掳浜滈柟瀛樼箖閸ゅ洭鏌熼鏂よ€挎鐐达耿椤㈡瑩鎮剧仦钘夌濠碉紕鍋戦崐鏍涙笟鈧畷鎴﹀箛椤斿墽鐓嬮梺缁樺灦閿曗晛鈻撴禒瀣厽闁归偊鍘奸ˉ瀣磼閹邦厽鈷愭い銊ｅ劦閹瑩寮堕幋鐐剁檨婵°倗濮烽崑娑㈩敄閸涙潙鐓橀柟杈剧畱缁犳稒銇勯弮鍌涘殌濞存粓绠栭弻鐔煎箚閺夊晝鎾绘煃闁垮绗掗棁澶愭煥濠靛棙鍣洪柛鐔哄仱閺岀喖顢涘鍗烆杸闂侀潧娲ょ€氫即鐛€ｎ亖鏀介柛銉ㄥ煐閿涘棝鏌ｆ惔銈庢綈婵炲弶鐗滅槐鐐寸節閸屾粍娈剧紓浣割儓椤曟娊寮崼婵堝姦濡炪倖甯掔€氼厾鈧艾鎳橀弻锝夊棘閸喗鍊梺缁樻尪閸庤尙鎹㈠☉銏犵闁诲繑妞挎禍顏堛€侀弮鍫澪у璺侯儑閸橀亶鏌ｆ惔顖滅У闁稿鎳庨悾宄扮暆閸曨剛鍘告繛杈剧悼閹虫挻鎱ㄩ崼銉︾厵妞ゆ牗绋掗悡銉╂煃鐟欏嫬鐏寸€规洘鍎奸ˇ鎶芥煟韫囨梹宕屾慨濠傤煼瀹曟帒鈻庨幒鎴濆腐缂傚倷绶￠崳顕€宕归崼鏇犲祦闁圭増婢樼粻鐟懊归敐鍡欐憙鐞氭繈姊虹拠鎻掑毐缂傚秴妫濆畷浼村箻鐠囪尙鍔﹀銈嗗坊閸嬫捇鏌涢悢椋庢憼濞ｅ洤锕幃婊堟寠婢跺苯骞愰梻浣呵归張顒勫春閸愵喖纾婚柟鍓х帛閸婂鏌ら幁鎺戝姢闁告ê澧界槐鎺楁倷椤掍胶鍑￠悗瑙勬处閸撴岸寮查崼鏇熷亱闁割偅绋愮花濠氭⒑閸濆嫬鏆婇柛瀣崌閹粙顢涘璇蹭壕闁归鐒︾紞搴ㄦ⒑閹呯妞ゎ偄顦遍埀顒佺瀹€鎼佸蓟瀹ュ唯闁靛⿵濡囪ぐ褔姊虹拠鑼缂佸澧庡Σ鎰板箻鐎靛摜鎳濋梺鎼炲劀閸曨厺鎲鹃梻鍌欑濠€閬嶅箠閹捐秮娲敇閵忊€充粧濡炪倖姊婚弲顐ゅ姬閳ь剟姊洪幖鐐插姌闁告柨鐭傞崺鈧い鎺戝€搁崢鎾煛鐏炲墽鈽夐柍瑙勫灴瀹曞崬螖閸愩劌鍤戦梻鍌欑窔濞佳嗗闂佸搫鎳忕划鎾诲箖閿熺姴唯闁冲搫鍊婚崢鎼佹⒑閸涘﹤濮傞柛鏂跨焸閸┾偓妞ゆ巻鍋撴い顓犲厴閻涱喖螖閸涱厾锛滃┑顕嗙秵閸樿偐绱炴繝鍥х畺闁宠桨璁查弸搴ㄧ叓閸ャ劍鐓ユい锔规櫊濮婃椽骞庨懞銉︽殸闁汇埄鍨界换婵嗩嚕鐠囨祴妲堟慨姗嗗亝閸曞啴姊洪崨濠冨瘷闁告洦鍋呴悵顔尖攽閿涘嫬浜奸柛濞у懏濯奸柨婵嗘川娑撳秹鏌熼幑鎰靛殭闁藉啰鍠栭弻锝夊棘閹稿孩鍎撻梺鍝勵儏閻楁捇寮诲☉妯滄棃宕橀妸銈囬挼闂備礁鎽滄慨鎾晝椤忓牆绠栨俊銈呭暞閸犲棝鏌涢弴銊ュ妞わ负鍔戝娲川婵犲啠鎷归梺鑽ゅ枂閸庣敻骞冩ィ鍐╃叆閻庯綆鍓熷顔剧磽娴ｅ壊鍎忛柣蹇旂箓閻ｇ敻宕卞☉娆屾嫼缂傚倷鐒﹂敋濠殿喖顦伴妵鍕晲鎼粹剝鐏撳┑鈥冲级閸旀瑩銆佸璺虹劦妞ゆ巻鍋撴い顐㈢箳缁辨帒螣鐠囧樊鈧捇姊洪崨濠勨槈闁挎洏鍎靛畷鏇㈠箻閸撲胶锛濇繛杈剧到婢瑰﹪宕曟惔锝囩＜闁奸晲绲绘竟姗€鏌ｉ敐鍥у幋妤犵偛顑夐弫鍐焵椤掑嫭鍊块柛顭戝亖娴滄粓鏌熼悜妯虹仴妞ゅ浚浜弻锝夊箻鐎涙顦伴梺璇″枟椤ㄥ﹪寮幇顓熷劅闁炽儴灏欓崙褰掓⒑鐠囪尙绠版繛瀛樺哺瀹曘垺绂掔€ｎ€箓鏌涢弴銊ョ伇闁轰礁鍟撮弻銊モ攽閸℃ê绐涢梺姹囧€曠€氼剟鈥旈崘顔嘉ч柛鎰╁妿娴犳儳顪冮妶鍐ㄥ闁挎洏鍊濋幃楣冩倻閽樺顔婇梺鐟扮摠濮婂綊寮悩缁樷拺缂備焦锚婵箑霉濠婂嫮鐭嬮柟渚垮姂瀹曟帒鈽夊▎蹇撲紟濠电姷鏁告慨鎾疮椤栫偛桅婵犻潧鐗冮崑鎾舵喆閸曨剙顦╅梺绋款儏閿曘倝鎮鹃悜鑺ュ亜缁炬媽椴搁弲顏堟⒑閸涘﹣绶遍柛鐘崇洴瀵尪顦规慨濠傤煼瀹曟帒鈻庨幋顓熜滈梻浣筋潐缁佹挳鍩€椤掍礁澧繛鍏肩墱閹叉悂鎮ч崼婵堢懆闂佹悶鍔岄崐鍧楀蓟濞戞粠妲煎銈冨妼閻楀棝鎮鹃崹顐ょ懝闁逞屽墴瀵鈽夐姀鐘电杸闂傚倸鐗婄粙鎺楁倶閸繍娓婚柕鍫濋娴滄粓鏌熼搹顐€跨€殿喖顭峰鎾閻樿鏁规繝鐢靛█濞佳兠洪妶鍛瀺闁挎繂娲ㄧ壕钘壝归敐鍥ㄥ殌濠殿喖鐗忕槐鎺斺偓锝庡亜缁椦囨煙楠炲灝鐏╅柍瑙勫灩閳ь剨缍嗛崑鍕濞差亝鈷掗柛灞炬皑婢ф盯鏌涢幒鍡椾壕闂備線娼х换鍫ュ磹閺嶎厼纾归柛顭戝亝閸欏繑鎱ㄥ璇蹭壕濠碘槅鍋夊▔鏇㈡嚍闁秵鍤嶉柕澶堝€楃粻姘舵⒑閸涘﹦鎳冩い锔诲灡閹便劌顓奸崶锝呬壕婵炲牆鐏濋弸鐔兼煙濮濆本鐝柟渚垮姂閸┾偓妞ゆ帒瀚悡鍐⒑濞嗘儳鐏犲ù婊堢畺濮婇缚銇愰幒婵囶棖缂備緡鍣崹鎶藉箲閵忕姭妲堟繛鍡樺姉缁夊爼姊洪崨濠冨瘷闁告劑鍔庨崢鎺楁⒒閸屾瑨鍏屾い銏狅攻閹便劑濡堕崶褍鐏婇柟鑹版彧缁蹭粙宕瑰┑瀣厸闁告劑鍔庢晶娑㈡煕婵犲嫮甯涘ǎ鍥э躬椤㈡盯鎮欑€涙褰哥紓鍌欓檷閸斿矂鈥﹀畡閭︽綎婵炲樊浜濋ˉ鍫熺箾閹达綁鍝烘い搴℃濮婂宕掑顒変患闁诲孩鍑归崜鐔煎箖閹呮殝闁规鍠楀▓鏇㈡⒑闁偛鑻晶鎾煕閳规儳浜炬俊鐐€栫敮鎺楀窗濮橆剦鐒介柟閭﹀幘缁犻箖鏌涘▎蹇ｆ闁兼澘娼￠弻鏇㈠幢濡も偓閺嗭絿鈧娲忛崝宥咁焽韫囨稑绀堢憸蹇涘煟閵堝棛绡€闁汇垽娼у瓭闂佹寧娲忛崐婵嬪箖瑜斿畷鍗炩槈濞嗗繆鍋撻崸妤佺厱妞ゎ厽鍨垫禍鏍瑰⿰鍕煉闁哄瞼鍠栧畷顐﹀礋椤掑顥ｅ┑鐐茬摠缁秹宕曢幎瑙ｂ偓鏃堝礃椤斿槈褔鏌涢埄鍐剧劷闁宠绋撶槐鎾诲磼濮樻瘷锛勭磼閼搁潧鍝哄┑鈥崇摠缁楃喖鍩€椤掆偓椤曪綁骞橀纰辨綂闂佹枼鏅涢崯顖炴偟閺嶎厽鈷掑〒姘ｅ亾闁逞屽墰閸嬫盯鎳熼娑欐珷闁规鍠氱壕鍏笺亜閺傚灝鈷旈悽顖涚〒缁辨帞绱掑Ο鑲╃暤濡炪値鍋呯换鍫ャ€佸鈧幃娆撳级閸噮鍤欓梻鍌氬€搁崐鐑芥倿閿曞倸绠栭柛顐ｆ礀绾炬寧绻濇繝鍌滃缂佲偓閸愨斂浜滈煫鍥ㄦ尵婢с垻鈧娲樼划宀勫煘閹达附鏅柛鏇ㄥ亗閺夘參姊虹粙鍖℃敾闁搞劌鐏濋悾鐑藉即閵忊€虫濡炪倖甯婄粈浣规償婵犲洦鈷戦柛鎾村絻娴滄繄绱掔拠鑼㈡い顓炴喘瀵粙濡歌椤旀洟鎮楅悷鏉款棌闁哥姵娲滈懞閬嶅礂缁楄桨绨婚梺闈涱槶閸庤櫕鏅跺☉姘辩＜缂備焦顭囧ú瀛橆殽閻愬樊鍎旈柟顔界懅閹瑰嫭绗熼娑辨（婵犵绱曢崑鎴﹀磹瑜忓濠冪鐎ｎ亞顔愬銈嗗姧缁犳垿鎮″鈧弻鐔告綇閸撗呮殸闂佺粯鎼换婵嬪蓟濞戙垹鐒洪柛鎰剁細濞岊亞绱撴担闈涘闁告鍥ｂ偓鏃堝礃椤斿槈褔鏌涢幇鈺佸妞ゎ剙鐗撳娲箰鎼淬垹顦╂繛瀛樼矤娴滄繃绌辨繝鍕ㄥ亾濞戞瑯鐒介柣鐔风秺閺屽秷顧侀柛鎾寸懇椤㈡岸鏁愭径妯绘櫔闂侀€炲苯澧柣锝囧厴閹剝鎯斿Ο缁樻澑闂佽鍑界紞鍡樼濠靛姹叉い蹇撶墛閳锋帡鏌涚仦鍓ф噮妞わ讣绠撻弻鐔哄枈閸楃偘绨婚柣鎾卞€濋弻鏇熺箾閻愵剚鐝旈梺姹囧€ら崳锝夊蓟濞戞粠妲煎銈冨妼閹虫劗鍒掓繝姘兼晬婵炴垶姘ㄩ鏇㈡倵閻熸澘顥忛柛鐘虫礈閼鸿鲸绺介崨濠勫幗闂佽宕樺▔娑㈠几濞戙垺鐓涚€光偓鐎ｎ剙鍩岄柧浼欑秮閺屾稑鈹戦崱妤婁患缂備焦顨忛崣鍐潖濞差亝鍋傞幖绮规濡本绻涚€涙鐭ゅù婊庝簻椤曪絿鎷犲ù瀣潔闂侀潧绻掓慨鐢杆夊┑瀣厽闁绘ê鍘栭懜顏堟煕閺傚潡鍙勭€规洘绻堥、娑㈡倷閺夋垟鍋撻崹顐ょ闁割偅绻勬禒銏ゆ煛鐎ｎ剙鏋涢柡宀€鍠栭、娆撴偂鎼存ê浜鹃柛褎顨嗛崑妯汇亜閺冨牊鏆滈柛瀣崌閺佹劖鎯旈埄鍐憾闂備礁鎼幊蹇曞垝閹捐钃熼柨婵嗩槹閺呮煡鏌涘☉娆愮凡妞ゅ浚鍘艰灃闁绘﹢娼ф禒锕傛煕閺冣偓閻熴儵锝炶箛娑欐優閻熸瑥瀚悵浼存⒑閸︻厾甯涢悽顖涘笒琚欓柟閭﹀枤绾句粙鏌涚仦鐐殤鐎涙繂鈹戦埥鍡椾簼闁荤啙鍛灊閻庯綆浜堕崥瀣熆鐠虹尨韬柛鐐茬埣濮婃椽宕崟顒€绐涢梺鍝ュТ鐎涒晝绮嬪鍛傛棃宕ㄩ瑙勫缂傚倷绀侀鍫濃枖閺囩姷涓嶉柟鎯板Г閻撳啰鈧懓瀚竟鍡樻櫠閺囥垺鐓冪紓浣股戠亸鎵磼閸屾稑绗ч柍褜鍓ㄧ紞鍡涘磻閸℃稑鍌ㄥù鐘差儐閳锋垹鎲搁悧鍫濈瑨濞存粈鍗抽弻娑㈠Ω閵堝懎绁梺璇″灠閸熸挳骞栬ぐ鎺戞嵍妞ゆ挾濯寸槐鏌ユ⒒娴ｈ櫣甯涢柨姘繆椤栨熬韬柟顔瑰墲缁轰粙宕ㄦ繝鍕箰闁诲骸鍘滈崑鎾绘倵閿濆骸澧伴柨娑氬枑缁绘稓鈧數枪椤庢挸鈹戦垾铏枠妤犵偛绻橀幃鈺冩嫚閼碱剦鍞介梻浣告贡閸庛倗鎹㈤崟顖氱劦妞ゆ帒鍊搁崢瀛樻叏婵犲嫮甯涚紒妤冨枛閸┾偓妞ゆ帒瀚悞鍨亜閹烘垵鈧憡绂掑⿰鍫熺厾婵炶尪顕ч悘锟犳煛閸涱厾鍩ｇ€规洘绮忛ˇ瀵哥棯閹佸仮婵☆偄鎳橀、鏇㈩敃閵忕姷顔掗梻浣规た閸樹粙鎮烽埡鍛摕闁绘梻鈷堥弫濠囨煟椤撗冧航濞存粠浜弫鎰版倷濞村鏂€闁诲函绲介悘姘跺疾閿濆鍋℃繝濠傚暣閸欏嫭銇勯姀锛勬噰鐎殿噮鍣ｅ畷濂告偄閸欏顏归梻鍌欑閹诧紕绮欓幋锔芥櫇闁靛绠戠欢鐐烘煕閺囥劌鐏￠柣鎾存礋閺屾洘绻涢悙顒佺彃闂佽鐓＄粻鏍蓟濞戙垹鐓涢柛灞剧矋閸掓稑螖閻橀潧浠﹂悽顖ょ節閻涱喗绻濋崶顬晠鏌曟竟顖氭啗閵娾晜鈷戦弶鐐村閸斿秹鏌涢弮鈧悷銉╂偩閻戣姤鍋傞幖鎼枤閸為潧顪冮妶鍡楃瑐闁绘帪濡囨禍鎼佹偨閸涘﹦鍘介梺闈涱樈閸犳洟鏌囬娑栦簻闁靛繆妲勯懓鍧楁煙椤旂晫鎳囨俊顐㈠暙閳藉顫濋鈧粻娲⒒閸屾艾鈧绮堟笟鈧獮鏍敃閿曗偓鐎氬銇勯幒鎴濐仾闁稿骸瀛╅妵鍕冀椤愵澀绮剁紓浣哄У閻楃娀寮诲澶婁紶闁告洦鍓欏▍銈夋⒑鐠団€崇仯闁稿鍋ゆ俊鐢稿礋椤栨氨鐤€闂佸疇妗ㄩ懗鑸电閹€鏀介柣鎰皺婢ч亶鏌涚€ｎ亝顥犳俊鍙夊姍楠炴鎷犻懠顒婄床婵犵數鍋涘Λ娆撳垂閼测晝鐜绘俊銈呮噺閳锋垿鏌涘┑鍕姎閺嶏繝姊虹紒姗嗘畼濠电偐鍋撻悗娈垮櫘閸嬪﹤鐣峰鈧、娆撴嚍閵夛妇褰嗛梻鍌欑閹诧繝骞愰崱娑樻そ闁告劦浜Λ鐑芥⒒閸屾艾鈧兘鎳楅崼鏇炵疇闁规儳鐡ㄥ▍鐘绘煟閿濆懓瀚伴柛銊︾箖閵囧嫰寮介顫捕闂佹眹鍊濈粻鏍蓟閻斿吋鈷掗悗鐢登规俊浠嬫⒑缂佹ɑ灏柛搴ｆ暬瀵鏁愭径濠傚祮闂佺粯鍔栫粊鎾磻閹捐鎹舵い鎾寸☉娴滅偓鎱ㄥΟ鐓庝壕閻庢熬鎷�");
        //%%%%%%%%%%%%%%%%%%%%%%%%%%%%  (Exz Ezx 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌涘☉姗堟敾闁告瑥绻橀弻锝夊箣閿濆棭妫勯梺鍝勵儎缁舵岸寮婚悢鍏尖拻閻庨潧澹婂Σ顔剧磼閻愵剙鍔ゆい顓犲厴瀵鏁愭径濠勭杸濡炪倖甯婇悞锕傚磿閹剧粯鈷戦柟鑲╁仜婵″ジ鏌涙繝鍌涘仴鐎殿喛顕ч埥澶愬閳哄倹娅囬梻浣瑰缁诲倸螞濞戔懞鍥Ψ瑜忕壕钘壝归敐鍛儓鐏忓繘姊洪崨濠庢畷濠电偛锕ら锝嗙節濮橆厼浜滈梺鎯х箰濠€閬嶆晬濠婂牊鈷戦梻鍫熺〒缁犲啿鈹戦鐐毈闁诡喗锕㈠畷濂稿閵忣澁绱查梻浣虹帛閸旓箓宕滃▎鎾崇闁靛牆妫庢禍婊勩亜閹捐泛孝闁告ê顕埀顒侇問閸犳牠鈥﹂悜钘夌畺闁靛繈鍊栭崑鍌炲箹鏉堝墽绉垫俊鎻掔埣閺岋綁鎮㈤崫銉х厐缂備胶绮敮鈥愁嚕椤愶富鏁婇悘蹇旂墬椤秹姊洪棃娑㈢崪缂佽鲸娲熷畷銏ゅ箻缂佹ǚ鎷绘繛杈剧到閹芥粍绂掗姀掳浜滈柟瀛樼箖閸ゅ洭鏌熼鏂よ€挎鐐达耿椤㈡瑩鎮剧仦钘夌濠碉紕鍋戦崐鏍涙笟鈧畷鎴﹀箛椤斿墽鐓嬮梺缁樺灦閿曗晛鈻撴禒瀣厽闁归偊鍘奸ˉ瀣磼閹邦厽鈷愭い銊ｅ劦閹瑩寮堕幋鐐剁檨婵°倗濮烽崑娑㈩敄閸涙潙鐓橀柟杈剧畱缁犳稒銇勯弮鍌涘殌濞存粓绠栭弻鐔煎箚閺夊晝鎾绘煃闁垮绗掗棁澶愭煥濠靛棙鍣洪柛鐔哄仱閺岀喖顢涘鍗烆杸闂侀潧娲ょ€氫即鐛€ｎ亖鏀介柛銉ㄥ煐閿涘棝鏌ｆ惔銈庢綈婵炲弶鐗滅槐鐐寸節閸屾粍娈剧紓浣割儓椤曟娊寮崼婵堝姦濡炪倖甯掔€氼厾鈧艾鎳橀弻锝夊棘閸喗鍊梺缁樻尪閸庤尙鎹㈠☉銏犵闁诲繑妞挎禍顏堛€侀弮鍫澪у璺侯儑閸橀亶鏌ｆ惔顖滅У闁稿鎳庨悾宄扮暆閸曨剛鍘告繛杈剧悼閹虫挻鎱ㄩ崼銉︾厵妞ゆ牗绋掗悡銉╂煃鐟欏嫬鐏寸€规洘鍎奸ˇ鎶芥煟韫囨梹宕屾慨濠傤煼瀹曟帒鈻庨幒鎴濆腐缂傚倷绶￠崳顕€宕归崼鏇犲祦闁圭増婢樼粻鐟懊归敐鍡欐憙鐞氭繈姊虹拠鎻掑毐缂傚秴妫濆畷浼村箻鐠囪尙鍔﹀銈嗗坊閸嬫捇鏌涢悢椋庢憼濞ｅ洤锕幃婊堟寠婢跺苯骞愰梻浣呵归張顒勫春閸愵喖纾婚柟鍓х帛閸婂鏌ら幁鎺戝姢闁告ê澧界槐鎺楁倷椤掍胶鍑￠悗瑙勬处閸撴岸寮查崼鏇熷亱闁割偅绋愮花濠氭⒑閸濆嫬鏆婇柛瀣崌閹粙顢涘璇蹭壕闁归鐒︾紞搴ㄦ⒑閹呯妞ゎ偄顦遍埀顒佺瀹€鎼佸蓟瀹ュ唯闁靛⿵濡囪ぐ褔姊虹拠鑼缂佸澧庡Σ鎰板箻鐎靛摜鎳濋梺鎼炲劀閸曨厺鎲鹃梻鍌欑濠€閬嶅箠閹捐秮娲敇閵忊€充粧濡炪倖姊婚弲顐ゅ姬閳ь剟姊洪幖鐐插姌闁告柨鐭傞崺鈧い鎺戝€搁崢鎾煛鐏炲墽鈽夐柍瑙勫灴瀹曞崬螖閸愩劌鍤戦梻鍌欑窔濞佳嗗闂佸搫鎳忕划鎾诲箖閿熺姴唯闁冲搫鍊婚崢鎼佹⒑閸涘﹤濮傞柛鏂跨焸閸┾偓妞ゆ巻鍋撴い顓犲厴閻涱喖螖閸涱厾锛滃┑顕嗙秵閸樿偐绱炴繝鍥х畺闁宠桨璁查弸搴ㄧ叓閸ャ劍鐓ユい锔规櫊濮婃椽骞庨懞銉︽殸闁汇埄鍨界换婵嗩嚕鐠囨祴妲堟慨姗嗗亝閸曞啴姊洪崨濠冨瘷闁告洦鍋呴悵顔尖攽閿涘嫬浜奸柛濞у懏濯奸柨婵嗘川娑撳秹鏌熼幑鎰靛殭闁藉啰鍠栭弻锝夊棘閹稿孩鍎撻梺鍝勵儏閻楁捇寮诲☉妯滄棃宕橀妸銈囬挼闂備礁鎽滄慨鎾晝椤忓牆绠栨俊銈呭暞閸犲棝鏌涢弴銊ュ妞わ负鍔戝娲川婵犲啠鎷归梺鑽ゅ枂閸庣敻骞冩ィ鍐╃叆閻庯綆鍓熷顔剧磽娴ｅ壊鍎忛柣蹇旂箓閻ｇ敻宕卞☉娆屾嫼缂傚倷鐒﹂敋濠殿喖顦伴妵鍕晲鎼粹剝鐏撳┑鈥冲级閸旀瑩銆佸璺虹劦妞ゆ巻鍋撴い顐㈢箳缁辨帒螣鐠囧樊鈧捇姊洪崨濠勨槈闁挎洏鍎靛畷鏇㈠箻閸撲胶锛濇繛杈剧到婢瑰﹪宕曟惔锝囩＜闁奸晲绲绘竟姗€鏌ｉ敐鍥у幋妤犵偛顑夐弫鍐焵椤掑嫭鍊块柛顭戝亖娴滄粓鏌熼悜妯虹仴妞ゅ浚浜弻锝夊箻鐎涙顦伴梺璇″枟椤ㄥ﹪寮幇顓熷劅闁炽儴灏欓崙褰掓⒑鐠囪尙绠版繛瀛樺哺瀹曘垺绂掔€ｎ€箓鏌涢弴銊ョ伇闁轰礁鍟撮弻銊モ攽閸℃ê绐涢梺姹囧€曠€氼剟鈥旈崘顔嘉ч柛鎰╁妿娴犳儳顪冮妶鍐ㄥ闁挎洏鍊濋幃楣冩倻閽樺顔婇梺鐟扮摠濮婂綊寮悩缁樷拺缂備焦锚婵箑霉濠婂嫮鐭嬮柟渚垮姂瀹曟帒鈽夊▎蹇撲紟濠电姷鏁告慨鎾疮椤栫偛桅婵犻潧鐗冮崑鎾舵喆閸曨剙顦╅梺绋款儏閿曘倝鎮鹃悜鑺ュ亜缁炬媽椴搁弲顏堟⒑閸涘﹣绶遍柛鐘崇洴瀵尪顦规慨濠傤煼瀹曟帒鈻庨幋顓熜滈梻浣筋潐缁佹挳鍩€椤掍礁澧繛鍏肩墱閹叉悂鎮ч崼婵堢懆闂佹悶鍔岄崐鍧楀蓟濞戞粠妲煎銈冨妼閻楀棝鎮鹃崹顐ょ懝闁逞屽墴瀵鈽夐姀鐘电杸闂傚倸鐗婄粙鎺楁倶閸繍娓婚柕鍫濋娴滄粓鏌熼搹顐€跨€殿喖顭峰鎾閻樿鏁规繝鐢靛█濞佳兠洪妶鍛瀺闁挎繂娲ㄧ壕钘壝归敐鍥ㄥ殌濠殿喖鐗忕槐鎺斺偓锝庡亜缁椦囨煙楠炲灝鐏╅柍瑙勫灩閳ь剨缍嗛崑鍕濞差亝鈷掗柛灞炬皑婢ф盯鏌涢幒鍡椾壕闂備線娼х换鍫ュ磹閺嶎厼纾归柛顭戝亝閸欏繑鎱ㄥ璇蹭壕濠碘槅鍋夊▔鏇㈡嚍闁秵鍤嶉柕澶堝€楃粻姘舵⒑閸涘﹦鎳冩い锔诲灡閹便劌顓奸崶锝呬壕婵炲牆鐏濋弸鐔兼煙濮濆本鐝柟渚垮姂閸┾偓妞ゆ帒瀚悡鍐⒑濞嗘儳鐏犲ù婊堢畺濮婇缚銇愰幒婵囶棖缂備緡鍣崹鎶藉箲閵忕姭妲堟繛鍡樺姉缁夊爼姊洪崨濠冨瘷闁告劑鍔庨崢鎺楁⒒閸屾瑨鍏屾い銏狅攻閹便劑濡堕崶褍鐏婇柟鑹版彧缁蹭粙宕瑰┑瀣厸闁告劑鍔庢晶娑㈡煕婵犲嫮甯涘ǎ鍥э躬椤㈡盯鎮欑€涙褰哥紓鍌欓檷閸斿矂鈥﹀畡閭︽綎婵炲樊浜濋ˉ鍫熺箾閹达綁鍝烘い搴℃濮婂宕掑顒変患闁诲孩鍑归崜鐔煎箖閹呮殝闁规鍠楀▓鏇㈡⒑闁偛鑻晶鎾煕閳规儳浜炬俊鐐€栫敮鎺楀窗濮橆剦鐒介柟閭﹀幘缁犻箖鏌涘▎蹇ｆ闁兼澘娼￠弻鏇㈠幢濡も偓閺嗭絿鈧娲忛崝宥咁焽韫囨稑绀堢憸蹇涘煟閵堝棛绡€闁汇垽娼у瓭闂佹寧娲忛崐婵嬪箖瑜斿畷鍗炩槈濞嗗繆鍋撻崸妤佺厱妞ゎ厽鍨垫禍鏍瑰⿰鍕煉闁哄瞼鍠栧畷顐﹀礋椤掑顥ｅ┑鐐茬摠缁秹宕曢幎瑙ｂ偓鏃堝礃椤斿槈褔鏌涢埄鍐剧劷闁宠绋撶槐鎾诲磼濮樻瘷锛勭磼閼搁潧鍝哄┑鈥崇摠缁楃喖鍩€椤掆偓椤曪綁骞橀纰辨綂闂佹枼鏅涢崯顖炴偟閺嶎厽鈷掑〒姘ｅ亾闁逞屽墰閸嬫盯鎳熼娑欐珷闁规鍠氱壕鍏笺亜閺傚灝鈷旈悽顖涚〒缁辨帞绱掑Ο鑲╃暤濡炪値鍋呯换鍫ャ€佸鈧幃娆撳级閸噮鍤欓梻鍌氬€搁崐鐑芥倿閿曞倸绠栭柛顐ｆ礀绾炬寧绻濇繝鍌滃缂佲偓閸愨斂浜滈煫鍥ㄦ尵婢с垻鈧娲樼划宀勫煘閹达附鏅柛鏇ㄥ亗閺夘參姊虹粙鍖℃敾闁搞劌鐏濋悾鐑藉即閵忊€虫濡炪倖甯婄粈浣规償婵犲洦鈷戦柛鎾村絻娴滄繄绱掔拠鑼㈡い顓炴喘瀵粙濡歌椤旀洟鎮楅悷鏉款棌闁哥姵娲滈懞閬嶅礂缁楄桨绨婚梺闈涱槶閸庤櫕鏅跺☉姘辩＜缂備焦顭囧ú瀛橆殽閻愬樊鍎旈柟顔界懅閹瑰嫭绗熼娑辨（婵犵绱曢崑鎴﹀磹瑜忓濠冪鐎ｎ亞顔愬銈嗗姧缁犳垿鎮″鈧弻鐔告綇閸撗呮殸闂佺粯鎼换婵嬪蓟濞戙垹鐒洪柛鎰剁細濞岊亞绱撴担闈涘闁告鍥ｂ偓鏃堝礃椤斿槈褔鏌涢幇鈺佸妞ゎ剙鐗撳娲箰鎼淬垹顦╂繛瀛樼矤娴滄繃绌辨繝鍕ㄥ亾濞戞瑯鐒介柣鐔风秺閺屽秷顧侀柛鎾寸懇椤㈡岸鏁愭径妯绘櫔闂侀€炲苯澧柣锝囧厴閹剝鎯斿Ο缁樻澑闂佽鍑界紞鍡樼濠靛姹叉い蹇撶墛閳锋帡鏌涚仦鍓ф噮妞わ讣绠撻弻鐔哄枈閸楃偘绨婚柣鎾卞€濋弻鏇熺箾閻愵剚鐝旈梺姹囧€ら崳锝夊蓟濞戞粠妲煎銈冨妼閹虫劗鍒掓繝姘兼晬婵炴垶姘ㄩ鏇㈡倵閻熸澘顥忛柛鐘虫礈閼鸿鲸绺介崨濠勫幗闂佽宕樺▔娑㈠几濞戙垺鐓涚€光偓鐎ｎ剙鍩岄柧浼欑秮閺屾稑鈹戦崱妤婁患缂備焦顨忛崣鍐潖濞差亝鍋傞幖绮规濡本绻涚€涙鐭ゅù婊庝簻椤曪絿鎷犲ù瀣潔闂侀潧绻掓慨鐢杆夊┑瀣厽闁绘ê鍘栭懜顏堟煕閺傚潡鍙勭€规洘绻堥、娑㈡倷閺夋垟鍋撻崹顐ょ闁割偅绻勬禒銏ゆ煛鐎ｎ剙鏋涢柡宀€鍠栭、娆撴偂鎼存ê浜鹃柛褎顨嗛崑妯汇亜閺冨牊鏆滈柛瀣崌閺佹劖鎯旈埄鍐憾闂備礁鎼幊蹇曞垝閹捐钃熼柨婵嗩槹閺呮煡鏌涘☉娆愮凡妞ゅ浚鍘艰灃闁绘﹢娼ф禒锕傛煕閺冣偓閻熴儵锝炶箛娑欐優閻熸瑥瀚悵浼存⒑閸︻厾甯涢悽顖涘笒琚欓柟閭﹀枤绾句粙鏌涚仦鐐殤鐎涙繂鈹戦埥鍡椾簼闁荤啙鍛灊閻庯綆浜堕崥瀣熆鐠虹尨韬柛鐐茬埣濮婃椽宕崟顒€绐涢梺鍝ュТ鐎涒晝绮嬪鍛傛棃宕ㄩ瑙勫缂傚倷绀侀鍫濃枖閺囩姷涓嶉柟鎯板Г閻撳啰鈧懓瀚竟鍡樻櫠閺囥垺鐓冪紓浣股戠亸鎵磼閸屾稑绗ч柍褜鍓ㄧ紞鍡涘磻閸℃稑鍌ㄥù鐘差儐閳锋垹鎲搁悧鍫濈瑨濞存粈鍗抽弻娑㈠Ω閵堝懎绁梺璇″灠閸熸挳骞栬ぐ鎺戞嵍妞ゆ挾濯寸槐鏌ユ⒒娴ｈ櫣甯涢柨姘繆椤栨熬韬柟顔瑰墲缁轰粙宕ㄦ繝鍕箰闁诲骸鍘滈崑鎾绘倵閿濆骸澧伴柨娑氬枑缁绘稓鈧數枪椤庢挸鈹戦垾铏枠妤犵偛绻橀幃鈺冩嫚閼碱剦鍞介梻浣告贡閸庛倗鎹㈤崟顖氱劦妞ゆ帒鍊搁崢瀛樻叏婵犲嫮甯涚紒妤冨枛閸┾偓妞ゆ帒瀚悞鍨亜閹烘垵鈧憡绂掑⿰鍫熺厾婵炶尪顕ч悘锟犳煛閸涱厾鍩ｇ€规洘绮忛ˇ瀵哥棯閹佸仮婵☆偄鎳橀、鏇㈩敃閵忕姷顔掗梻浣规た閸樹粙鎮烽埡鍛摕闁绘梻鈷堥弫濠囨煟椤撗冧航濞存粠浜弫鎰版倷濞村鏂€闁诲函绲介悘姘跺疾閿濆鍋℃繝濠傚暣閸欏嫭銇勯姀锛勬噰鐎殿噮鍣ｅ畷濂告偄閸欏顏归梻鍌欑閹诧紕绮欓幋锔芥櫇闁靛绠戠欢鐐烘煕閺囥劌鐏￠柣鎾存礋閺屾洘绻涢悙顒佺彃闂佽鐓＄粻鏍蓟濞戙垹鐓涢柛灞剧矋閸掓稑螖閻橀潧浠﹂悽顖ょ節閻涱喗绻濋崶顬晠鏌曟竟顖氭啗閵娾晜鈷戦弶鐐村閸斿秹鏌涢弮鈧悷銉╂偩閻戣姤鍋傞幖鎼枤閸為潧顪冮妶鍡楃瑐闁绘帪濡囨禍鎼佹偨閸涘﹦鍘介梺闈涱樈閸犳洟鏌囬娑栦簻闁靛繆妲勯懓鍧楁煙椤旂晫鎳囨俊顐㈠暙閳藉顫濋鈧粻娲⒒閸屾艾鈧绮堟笟鈧獮鏍敃閿曗偓鐎氬銇勯幒鎴濐仾闁稿骸瀛╅妵鍕冀椤愵澀绮堕梺鍝勵儎缁舵岸寮婚悢鍏肩劷闁挎洍鍋撻柣蹇ョ秮閺岋綁濡堕崒姘闂傚倸鍊风粈渚€骞栭鈷氭椽濡搁敂钘夊伎闂傚倸鐗婄粙鍫ュ几閺冨牊鐓曢煫鍥ㄧ⊕閿涚喓绱掔拠鍙夘棦闁哄本娲熷畷鐓庘攽閸ャ劍鍊烽梺鍝ュ枑閹倸顫忛搹鍦煓婵炲棙鍎抽崜杈╃磽娴ｅ壊鍎愰柟鐟版喘閻涱噣骞嬮敃鈧～鍛存煟濞嗗苯浜惧┑鐐殿儠閸旀垿寮诲鍫闂佸憡鎸婚悷鈺呫€佸鑸垫櫜濠㈣埖蓱閺呮繈姊洪幐搴㈢５闁稿鎸剧槐鎺楁偐閸濆嫬鎯炵紓浣介哺閹稿骞忛崨瀛樺殐闁斥晛鍟悘銉╂煃鐠囪尙效濠殿喒鍋撻梺闈涚墕濡矂骞忓ú顏呯厽闁绘ê鍘栭懜顏堟煕閺傝儻瀚伴柍璇茬Ч楠炲洭鎮ч崼銏犲箥闂備礁鎲￠崹顖炲磹閺嶎偀鍋撳鐐?)  %%%%%%%%%%%%%%%%%%%%%%%%%%
        vector<vector<complex<double>>> Ezx1(NX, vector<complex<double>>(NY));
        vector<vector<complex<double>>> Exz1(NX, vector<complex<double>>(NY));

        for(int i=1;i<=NX;i++) 
        {
            for(int j=1;j<=NY;j++)
            {
                Ezx1[i-1][j-1]=(Ez1[i][j-1][Nair+NN]-Ez1[i-1][j-1][Nair+NN]+Ez1[i][j][Nair+NN]-Ez1[i-1][j][Nair+NN])/2.0/fmodel.A_X[i-1];
                Exz1[i-1][j-1]=(Ex1[i-1][j-1][Nair+NN+1]-Ex1[i-1][j-1][Nair+NN]+Ex1[i-1][j][Nair+NN+1]-Ex1[i-1][j][Nair+NN])/2.0/fmodel.C_Z[Nair+NN];
            }
        }
        //%%%%%%%%%%%%%%%%%%%%%%%%%%%%  (Eyx Exy 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌涘☉姗堟敾闁告瑥绻橀弻锝夊箣閿濆棭妫勯梺鍝勵儎缁舵岸寮婚悢鍏尖拻閻庨潧澹婂Σ顔剧磼閻愵剙鍔ゆい顓犲厴瀵鏁愭径濠勭杸濡炪倖甯婇悞锕傚磿閹剧粯鈷戦柟鑲╁仜婵″ジ鏌涙繝鍌涘仴鐎殿喛顕ч埥澶愬閳哄倹娅囬梻浣瑰缁诲倸螞濞戔懞鍥Ψ瑜忕壕钘壝归敐鍛儓鐏忓繘姊洪崨濠庢畷濠电偛锕ら锝嗙節濮橆厼浜滈梺鎯х箰濠€閬嶆晬濠婂牊鈷戦梻鍫熺〒缁犲啿鈹戦鐐毈闁诡喗锕㈠畷濂稿閵忣澁绱查梻浣虹帛閸旓箓宕滃▎鎾崇闁靛牆妫庢禍婊勩亜閹捐泛孝闁告ê顕埀顒侇問閸犳牠鈥﹂悜钘夌畺闁靛繈鍊栭崑鍌炲箹鏉堝墽绉垫俊鎻掔埣閺岋綁鎮㈤崫銉х厐缂備胶绮敮鈥愁嚕椤愶富鏁婇悘蹇旂墬椤秹姊洪棃娑㈢崪缂佽鲸娲熷畷銏ゅ箻缂佹ǚ鎷绘繛杈剧到閹芥粍绂掗姀掳浜滈柟瀛樼箖閸ゅ洭鏌熼鏂よ€挎鐐达耿椤㈡瑩鎮剧仦钘夌濠碉紕鍋戦崐鏍涙笟鈧畷鎴﹀箛椤斿墽鐓嬮梺缁樺灦閿曗晛鈻撴禒瀣厽闁归偊鍘奸ˉ瀣磼閹邦厽鈷愭い銊ｅ劦閹瑩寮堕幋鐐剁檨婵°倗濮烽崑娑㈩敄閸涙潙鐓橀柟杈剧畱缁犳稒銇勯弮鍌涘殌濞存粓绠栭弻鐔煎箚閺夊晝鎾绘煃闁垮绗掗棁澶愭煥濠靛棙鍣洪柛鐔哄仱閺岀喖顢涘鍗烆杸闂侀潧娲ょ€氫即鐛€ｎ亖鏀介柛銉ㄥ煐閿涘棝鏌ｆ惔銈庢綈婵炲弶鐗滅槐鐐寸節閸屾粍娈剧紓浣割儓椤曟娊寮崼婵堝姦濡炪倖甯掔€氼厾鈧艾鎳橀弻锝夊棘閸喗鍊梺缁樻尪閸庤尙鎹㈠☉銏犵闁诲繑妞挎禍顏堛€侀弮鍫澪у璺侯儑閸橀亶鏌ｆ惔顖滅У闁稿鎳庨悾宄扮暆閸曨剛鍘告繛杈剧悼閹虫挻鎱ㄩ崼銉︾厵妞ゆ牗绋掗悡銉╂煃鐟欏嫬鐏寸€规洘鍎奸ˇ鎶芥煟韫囨梹宕屾慨濠傤煼瀹曟帒鈻庨幒鎴濆腐缂傚倷绶￠崳顕€宕归崼鏇犲祦闁圭増婢樼粻鐟懊归敐鍡欐憙鐞氭繈姊虹拠鎻掑毐缂傚秴妫濆畷浼村箻鐠囪尙鍔﹀銈嗗坊閸嬫捇鏌涢悢椋庢憼濞ｅ洤锕幃婊堟寠婢跺苯骞愰梻浣呵归張顒勫春閸愵喖纾婚柟鍓х帛閸婂鏌ら幁鎺戝姢闁告ê澧界槐鎺楁倷椤掍胶鍑￠悗瑙勬处閸撴岸寮查崼鏇熷亱闁割偅绋愮花濠氭⒑閸濆嫬鏆婇柛瀣崌閹粙顢涘璇蹭壕闁归鐒︾紞搴ㄦ⒑閹呯妞ゎ偄顦遍埀顒佺瀹€鎼佸蓟瀹ュ唯闁靛⿵濡囪ぐ褔姊虹拠鑼缂佸澧庡Σ鎰板箻鐎靛摜鎳濋梺鎼炲劀閸曨厺鎲鹃梻鍌欑濠€閬嶅箠閹捐秮娲敇閵忊€充粧濡炪倖姊婚弲顐ゅ姬閳ь剟姊洪幖鐐插姌闁告柨鐭傞崺鈧い鎺戝€搁崢鎾煛鐏炲墽鈽夐柍瑙勫灴瀹曞崬螖閸愩劌鍤戦梻鍌欑窔濞佳嗗闂佸搫鎳忕划鎾诲箖閿熺姴唯闁冲搫鍊婚崢鎼佹⒑閸涘﹤濮傞柛鏂跨焸閸┾偓妞ゆ巻鍋撴い顓犲厴閻涱喖螖閸涱厾锛滃┑顕嗙秵閸樿偐绱炴繝鍥х畺闁宠桨璁查弸搴ㄧ叓閸ャ劍鐓ユい锔规櫊濮婃椽骞庨懞銉︽殸闁汇埄鍨界换婵嗩嚕鐠囨祴妲堟慨姗嗗亝閸曞啴姊洪崨濠冨瘷闁告洦鍋呴悵顔尖攽閿涘嫬浜奸柛濞у懏濯奸柨婵嗘川娑撳秹鏌熼幑鎰靛殭闁藉啰鍠栭弻锝夊棘閹稿孩鍎撻梺鍝勵儏閻楁捇寮诲☉妯滄棃宕橀妸銈囬挼闂備礁鎽滄慨鎾晝椤忓牆绠栨俊銈呭暞閸犲棝鏌涢弴銊ュ妞わ负鍔戝娲川婵犲啠鎷归梺鑽ゅ枂閸庣敻骞冩ィ鍐╃叆閻庯綆鍓熷顔剧磽娴ｅ壊鍎忛柣蹇旂箓閻ｇ敻宕卞☉娆屾嫼缂傚倷鐒﹂敋濠殿喖顦伴妵鍕晲鎼粹剝鐏撳┑鈥冲级閸旀瑩銆佸璺虹劦妞ゆ巻鍋撴い顐㈢箳缁辨帒螣鐠囧樊鈧捇姊洪崨濠勨槈闁挎洏鍎靛畷鏇㈠箻閸撲胶锛濇繛杈剧到婢瑰﹪宕曟惔锝囩＜闁奸晲绲绘竟姗€鏌ｉ敐鍥у幋妤犵偛顑夐弫鍐焵椤掑嫭鍊块柛顭戝亖娴滄粓鏌熼悜妯虹仴妞ゅ浚浜弻锝夊箻鐎涙顦伴梺璇″枟椤ㄥ﹪寮幇顓熷劅闁炽儴灏欓崙褰掓⒑鐠囪尙绠版繛瀛樺哺瀹曘垺绂掔€ｎ€箓鏌涢弴銊ョ伇闁轰礁鍟撮弻銊モ攽閸℃ê绐涢梺姹囧€曠€氼剟鈥旈崘顔嘉ч柛鎰╁妿娴犳儳顪冮妶鍐ㄥ闁挎洏鍊濋幃楣冩倻閽樺顔婇梺鐟扮摠濮婂綊寮悩缁樷拺缂備焦锚婵箑霉濠婂嫮鐭嬮柟渚垮姂瀹曟帒鈽夊▎蹇撲紟濠电姷鏁告慨鎾疮椤栫偛桅婵犻潧鐗冮崑鎾舵喆閸曨剙顦╅梺绋款儏閿曘倝鎮鹃悜鑺ュ亜缁炬媽椴搁弲顏堟⒑閸涘﹣绶遍柛鐘崇洴瀵尪顦规慨濠傤煼瀹曟帒鈻庨幋顓熜滈梻浣筋潐缁佹挳鍩€椤掍礁澧繛鍏肩墱閹叉悂鎮ч崼婵堢懆闂佹悶鍔岄崐鍧楀蓟濞戞粠妲煎銈冨妼閻楀棝鎮鹃崹顐ょ懝闁逞屽墴瀵鈽夐姀鐘电杸闂傚倸鐗婄粙鎺楁倶閸繍娓婚柕鍫濋娴滄粓鏌熼搹顐€跨€殿喖顭峰鎾閻樿鏁规繝鐢靛█濞佳兠洪妶鍛瀺闁挎繂娲ㄧ壕钘壝归敐鍥ㄥ殌濠殿喖鐗忕槐鎺斺偓锝庡亜缁椦囨煙楠炲灝鐏╅柍瑙勫灩閳ь剨缍嗛崑鍕濞差亝鈷掗柛灞炬皑婢ф盯鏌涢幒鍡椾壕闂備線娼х换鍫ュ磹閺嶎厼纾归柛顭戝亝閸欏繑鎱ㄥ璇蹭壕濠碘槅鍋夊▔鏇㈡嚍闁秵鍤嶉柕澶堝€楃粻姘舵⒑閸涘﹦鎳冩い锔诲灡閹便劌顓奸崶锝呬壕婵炲牆鐏濋弸鐔兼煙濮濆本鐝柟渚垮姂閸┾偓妞ゆ帒瀚悡鍐⒑濞嗘儳鐏犲ù婊堢畺濮婇缚銇愰幒婵囶棖缂備緡鍣崹鎶藉箲閵忕姭妲堟繛鍡樺姉缁夊爼姊洪崨濠冨瘷闁告劑鍔庨崢鎺楁⒒閸屾瑨鍏屾い銏狅攻閹便劑濡堕崶褍鐏婇柟鑹版彧缁蹭粙宕瑰┑瀣厸闁告劑鍔庢晶娑㈡煕婵犲嫮甯涘ǎ鍥э躬椤㈡盯鎮欑€涙褰哥紓鍌欓檷閸斿矂鈥﹀畡閭︽綎婵炲樊浜濋ˉ鍫熺箾閹达綁鍝烘い搴℃濮婂宕掑顒変患闁诲孩鍑归崜鐔煎箖閹呮殝闁规鍠楀▓鏇㈡⒑闁偛鑻晶鎾煕閳规儳浜炬俊鐐€栫敮鎺楀窗濮橆剦鐒介柟閭﹀幘缁犻箖鏌涘▎蹇ｆ闁兼澘娼￠弻鏇㈠幢濡も偓閺嗭絿鈧娲忛崝宥咁焽韫囨稑绀堢憸蹇涘煟閵堝棛绡€闁汇垽娼у瓭闂佹寧娲忛崐婵嬪箖瑜斿畷鍗炩槈濞嗗繆鍋撻崸妤佺厱妞ゎ厽鍨垫禍鏍瑰⿰鍕煉闁哄瞼鍠栧畷顐﹀礋椤掑顥ｅ┑鐐茬摠缁秹宕曢幎瑙ｂ偓鏃堝礃椤斿槈褔鏌涢埄鍐剧劷闁宠绋撶槐鎾诲磼濮樻瘷锛勭磼閼搁潧鍝哄┑鈥崇摠缁楃喖鍩€椤掆偓椤曪綁骞橀纰辨綂闂佹枼鏅涢崯顖炴偟閺嶎厽鈷掑〒姘ｅ亾闁逞屽墰閸嬫盯鎳熼娑欐珷闁规鍠氱壕鍏笺亜閺傚灝鈷旈悽顖涚〒缁辨帞绱掑Ο鑲╃暤濡炪値鍋呯换鍫ャ€佸鈧幃娆撳级閸噮鍤欓梻鍌氬€搁崐鐑芥倿閿曞倸绠栭柛顐ｆ礀绾炬寧绻濇繝鍌滃缂佲偓閸愨斂浜滈煫鍥ㄦ尵婢с垻鈧娲樼划宀勫煘閹达附鏅柛鏇ㄥ亗閺夘參姊虹粙鍖℃敾闁搞劌鐏濋悾鐑藉即閵忊€虫濡炪倖甯婄粈浣规償婵犲洦鈷戦柛鎾村絻娴滄繄绱掔拠鑼㈡い顓炴喘瀵粙濡歌椤旀洟鎮楅悷鏉款棌闁哥姵娲滈懞閬嶅礂缁楄桨绨婚梺闈涱槶閸庤櫕鏅跺☉姘辩＜缂備焦顭囧ú瀛橆殽閻愬樊鍎旈柟顔界懅閹瑰嫭绗熼娑辨（婵犵绱曢崑鎴﹀磹瑜忓濠冪鐎ｎ亞顔愬銈嗗姧缁犳垿鎮″鈧弻鐔告綇閸撗呮殸闂佺粯鎼换婵嬪蓟濞戙垹鐒洪柛鎰剁細濞岊亞绱撴担闈涘闁告鍥ｂ偓鏃堝礃椤斿槈褔鏌涢幇鈺佸妞ゎ剙鐗撳娲箰鎼淬垹顦╂繛瀛樼矤娴滄繃绌辨繝鍕ㄥ亾濞戞瑯鐒介柣鐔风秺閺屽秷顧侀柛鎾寸懇椤㈡岸鏁愭径妯绘櫔闂侀€炲苯澧柣锝囧厴閹剝鎯斿Ο缁樻澑闂佽鍑界紞鍡樼濠靛姹叉い蹇撶墛閳锋帡鏌涚仦鍓ф噮妞わ讣绠撻弻鐔哄枈閸楃偘绨婚柣鎾卞€濋弻鏇熺箾閻愵剚鐝旈梺姹囧€ら崳锝夊蓟濞戞粠妲煎銈冨妼閹虫劗鍒掓繝姘兼晬婵炴垶姘ㄩ鏇㈡倵閻熸澘顥忛柛鐘虫礈閼鸿鲸绺介崨濠勫幗闂佽宕樺▔娑㈠几濞戙垺鐓涚€光偓鐎ｎ剙鍩岄柧浼欑秮閺屾稑鈹戦崱妤婁患缂備焦顨忛崣鍐潖濞差亝鍋傞幖绮规濡本绻涚€涙鐭ゅù婊庝簻椤曪絿鎷犲ù瀣潔闂侀潧绻掓慨鐢杆夊┑瀣厽闁绘ê鍘栭懜顏堟煕閺傚潡鍙勭€规洘绻堥、娑㈡倷閺夋垟鍋撻崹顐ょ闁割偅绻勬禒銏ゆ煛鐎ｎ剙鏋涢柡宀€鍠栭、娆撴偂鎼存ê浜鹃柛褎顨嗛崑妯汇亜閺冨牊鏆滈柛瀣崌閺佹劖鎯旈埄鍐憾闂備礁鎼幊蹇曞垝閹捐钃熼柨婵嗩槹閺呮煡鏌涘☉娆愮凡妞ゅ浚鍘艰灃闁绘﹢娼ф禒锕傛煕閺冣偓閻熴儵锝炶箛娑欐優閻熸瑥瀚悵浼存⒑閸︻厾甯涢悽顖涘笒琚欓柟閭﹀枤绾句粙鏌涚仦鐐殤鐎涙繂鈹戦埥鍡椾簼闁荤啙鍛灊閻庯綆浜堕崥瀣熆鐠虹尨韬柛鐐茬埣濮婃椽宕崟顒€绐涢梺鍝ュТ鐎涒晝绮嬪鍛傛棃宕ㄩ瑙勫缂傚倷绀侀鍫濃枖閺囩姷涓嶉柟鎯板Г閻撳啰鈧懓瀚竟鍡樻櫠閺囥垺鐓冪紓浣股戠亸鎵磼閸屾稑绗ч柍褜鍓ㄧ紞鍡涘磻閸℃稑鍌ㄥù鐘差儐閳锋垹鎲搁悧鍫濈瑨濞存粈鍗抽弻娑㈠Ω閵堝懎绁梺璇″灠閸熸挳骞栬ぐ鎺戞嵍妞ゆ挾濯寸槐鏌ユ⒒娴ｈ櫣甯涢柨姘繆椤栨熬韬柟顔瑰墲缁轰粙宕ㄦ繝鍕箰闁诲骸鍘滈崑鎾绘倵閿濆骸澧伴柨娑氬枑缁绘稓鈧數枪椤庢挸鈹戦垾铏枠妤犵偛绻橀幃鈺冩嫚閼碱剦鍞介梻浣告贡閸庛倗鎹㈤崟顖氱劦妞ゆ帒鍊搁崢瀛樻叏婵犲嫮甯涚紒妤冨枛閸┾偓妞ゆ帒瀚悞鍨亜閹烘垵鈧憡绂掑⿰鍫熺厾婵炶尪顕ч悘锟犳煛閸涱厾鍩ｇ€规洘绮忛ˇ瀵哥棯閹佸仮婵☆偄鎳橀、鏇㈩敃閵忕姷顔掗梻浣规た閸樹粙鎮烽埡鍛摕闁绘梻鈷堥弫濠囨煟椤撗冧航濞存粠浜弫鎰版倷濞村鏂€闁诲函绲介悘姘跺疾閿濆鍋℃繝濠傚暣閸欏嫭銇勯姀锛勬噰鐎殿噮鍣ｅ畷濂告偄閸欏顏归梻鍌欑閹诧紕绮欓幋锔芥櫇闁靛绠戠欢鐐烘煕閺囥劌鐏￠柣鎾存礋閺屾洘绻涢悙顒佺彃闂佽鐓＄粻鏍蓟濞戙垹鐓涢柛灞剧矋閸掓稑螖閻橀潧浠﹂悽顖ょ節閻涱喗绻濋崶顬晠鏌曟竟顖氭啗閵娾晜鈷戦弶鐐村閸斿秹鏌涢弮鈧悷銉╂偩閻戣姤鍋傞幖鎼枤閸為潧顪冮妶鍡楃瑐闁绘帪濡囨禍鎼佹偨閸涘﹦鍘介梺闈涱樈閸犳洟鏌囬娑栦簻闁靛繆妲勯懓鍧楁煙椤旂晫鎳囨俊顐㈠暙閳藉顫濋鈧粻娲⒒閸屾艾鈧绮堟笟鈧獮鏍敃閿曗偓鐎氬銇勯幒鎴濐仾闁稿骸瀛╅妵鍕冀椤愵澀绮堕梺鍝勵儎缁舵岸寮婚悢鍏肩劷闁挎洍鍋撻柣蹇ョ秮閺岋綁濡堕崒姘闂傚倸鍊风粈渚€骞栭鈷氭椽濡搁敂钘夊伎闂傚倸鐗婄粙鍫ュ几閺冨牊鐓曢煫鍥ㄧ⊕閿涚喓绱掔拠鍙夘棦闁哄本娲熷畷鐓庘攽閸ャ劍鍊烽梺鍝ュ枑閹倸顫忛搹鍦煓婵炲棙鍎抽崜杈╃磽娴ｅ壊鍎愰柟鐟版喘閻涱噣骞嬮敃鈧～鍛存煟濞嗗苯浜惧┑鐐殿儠閸旀垿寮诲鍫闂佸憡鎸婚悷鈺呫€佸鑸垫櫜濠㈣埖蓱閺呮繈姊洪幐搴㈢５闁稿鎸剧槐鎺楁偐閸濆嫬鎯炵紓浣介哺閹稿骞忛崨瀛樺殐闁斥晛鍟悘銉╂煃鐠囪尙效濠殿喒鍋撻梺闈涚墕濡矂骞忓ú顏呯厽闁绘ê鍘栭懜顏堟煕閺傝儻瀚伴柍璇茬Ч楠炲洭鎮ч崼銏犲箥闂備礁鎲￠崹顖炲磹閺嶎偀鍋撳鐐?)  %%%%%%%%%%%%%%%%%%%%%%%%%%
        vector<vector<complex<double>>> Eyx1(NX, vector<complex<double>>(NY));
        vector<vector<complex<double>>> Exy1(NX, vector<complex<double>>(NY));

        for(int i=1;i<=NX;i++) 
        {
            for(int j=1;j<=NY;j++)
            {
                Eyx1[i-1][j-1]=(Ey1[i][j-1][Nair+NN]-Ey1[i-1][j-1][Nair+NN]+Ey1[i][j-1][Nair+NN+1]-Ey1[i-1][j-1][Nair+NN+1])/2.0/fmodel.A_X[i-1];
                Exy1[i-1][j-1]=(Ex1[i-1][j][Nair+NN]-Ex1[i-1][j-1][Nair+NN]+Ex1[i-1][j][Nair+NN+1]-Ex1[i-1][j-1][Nair+NN+1])/2.0/fmodel.B_Y[j-1];
            }
        }
        // %%%%%%%%%%%%%%%%%%%%%%%%%%%%  (Ezy Eyz 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌涘☉姗堟敾闁告瑥绻橀弻锝夊箣閿濆棭妫勯梺鍝勵儎缁舵岸寮婚悢鍏尖拻閻庨潧澹婂Σ顔剧磼閻愵剙鍔ゆい顓犲厴瀵鏁愭径濠勭杸濡炪倖甯婇悞锕傚磿閹剧粯鈷戦柟鑲╁仜婵″ジ鏌涙繝鍌涘仴鐎殿喛顕ч埥澶愬閳哄倹娅囬梻浣瑰缁诲倸螞濞戔懞鍥Ψ瑜忕壕钘壝归敐鍛儓鐏忓繘姊洪崨濠庢畷濠电偛锕ら锝嗙節濮橆厼浜滈梺鎯х箰濠€閬嶆晬濠婂牊鈷戦梻鍫熺〒缁犲啿鈹戦鐐毈闁诡喗锕㈠畷濂稿閵忣澁绱查梻浣虹帛閸旓箓宕滃▎鎾崇闁靛牆妫庢禍婊勩亜閹捐泛孝闁告ê顕埀顒侇問閸犳牠鈥﹂悜钘夌畺闁靛繈鍊栭崑鍌炲箹鏉堝墽绉垫俊鎻掔埣閺岋綁鎮㈤崫銉х厐缂備胶绮敮鈥愁嚕椤愶富鏁婇悘蹇旂墬椤秹姊洪棃娑㈢崪缂佽鲸娲熷畷銏ゅ箻缂佹ǚ鎷绘繛杈剧到閹芥粍绂掗姀掳浜滈柟瀛樼箖閸ゅ洭鏌熼鏂よ€挎鐐达耿椤㈡瑩鎮剧仦钘夌濠碉紕鍋戦崐鏍涙笟鈧畷鎴﹀箛椤斿墽鐓嬮梺缁樺灦閿曗晛鈻撴禒瀣厽闁归偊鍘奸ˉ瀣磼閹邦厽鈷愭い銊ｅ劦閹瑩寮堕幋鐐剁檨婵°倗濮烽崑娑㈩敄閸涙潙鐓橀柟杈剧畱缁犳稒銇勯弮鍌涘殌濞存粓绠栭弻鐔煎箚閺夊晝鎾绘煃闁垮绗掗棁澶愭煥濠靛棙鍣洪柛鐔哄仱閺岀喖顢涘鍗烆杸闂侀潧娲ょ€氫即鐛€ｎ亖鏀介柛銉ㄥ煐閿涘棝鏌ｆ惔銈庢綈婵炲弶鐗滅槐鐐寸節閸屾粍娈剧紓浣割儓椤曟娊寮崼婵堝姦濡炪倖甯掔€氼厾鈧艾鎳橀弻锝夊棘閸喗鍊梺缁樻尪閸庤尙鎹㈠☉銏犵闁诲繑妞挎禍顏堛€侀弮鍫澪у璺侯儑閸橀亶鏌ｆ惔顖滅У闁稿鎳庨悾宄扮暆閸曨剛鍘告繛杈剧悼閹虫挻鎱ㄩ崼銉︾厵妞ゆ牗绋掗悡銉╂煃鐟欏嫬鐏寸€规洘鍎奸ˇ鎶芥煟韫囨梹宕屾慨濠傤煼瀹曟帒鈻庨幒鎴濆腐缂傚倷绶￠崳顕€宕归崼鏇犲祦闁圭増婢樼粻鐟懊归敐鍡欐憙鐞氭繈姊虹拠鎻掑毐缂傚秴妫濆畷浼村箻鐠囪尙鍔﹀銈嗗坊閸嬫捇鏌涢悢椋庢憼濞ｅ洤锕幃婊堟寠婢跺苯骞愰梻浣呵归張顒勫春閸愵喖纾婚柟鍓х帛閸婂鏌ら幁鎺戝姢闁告ê澧界槐鎺楁倷椤掍胶鍑￠悗瑙勬处閸撴岸寮查崼鏇熷亱闁割偅绋愮花濠氭⒑閸濆嫬鏆婇柛瀣崌閹粙顢涘璇蹭壕闁归鐒︾紞搴ㄦ⒑閹呯妞ゎ偄顦遍埀顒佺瀹€鎼佸蓟瀹ュ唯闁靛⿵濡囪ぐ褔姊虹拠鑼缂佸澧庡Σ鎰板箻鐎靛摜鎳濋梺鎼炲劀閸曨厺鎲鹃梻鍌欑濠€閬嶅箠閹捐秮娲敇閵忊€充粧濡炪倖姊婚弲顐ゅ姬閳ь剟姊洪幖鐐插姌闁告柨鐭傞崺鈧い鎺戝€搁崢鎾煛鐏炲墽鈽夐柍瑙勫灴瀹曞崬螖閸愩劌鍤戦梻鍌欑窔濞佳嗗闂佸搫鎳忕划鎾诲箖閿熺姴唯闁冲搫鍊婚崢鎼佹⒑閸涘﹤濮傞柛鏂跨焸閸┾偓妞ゆ巻鍋撴い顓犲厴閻涱喖螖閸涱厾锛滃┑顕嗙秵閸樿偐绱炴繝鍥х畺闁宠桨璁查弸搴ㄧ叓閸ャ劍鐓ユい锔规櫊濮婃椽骞庨懞銉︽殸闁汇埄鍨界换婵嗩嚕鐠囨祴妲堟慨姗嗗亝閸曞啴姊洪崨濠冨瘷闁告洦鍋呴悵顔尖攽閿涘嫬浜奸柛濞у懏濯奸柨婵嗘川娑撳秹鏌熼幑鎰靛殭闁藉啰鍠栭弻锝夊棘閹稿孩鍎撻梺鍝勵儏閻楁捇寮诲☉妯滄棃宕橀妸銈囬挼闂備礁鎽滄慨鎾晝椤忓牆绠栨俊銈呭暞閸犲棝鏌涢弴銊ュ妞わ负鍔戝娲川婵犲啠鎷归梺鑽ゅ枂閸庣敻骞冩ィ鍐╃叆閻庯綆鍓熷顔剧磽娴ｅ壊鍎忛柣蹇旂箓閻ｇ敻宕卞☉娆屾嫼缂傚倷鐒﹂敋濠殿喖顦伴妵鍕晲鎼粹剝鐏撳┑鈥冲级閸旀瑩銆佸璺虹劦妞ゆ巻鍋撴い顐㈢箳缁辨帒螣鐠囧樊鈧捇姊洪崨濠勨槈闁挎洏鍎靛畷鏇㈠箻閸撲胶锛濇繛杈剧到婢瑰﹪宕曟惔锝囩＜闁奸晲绲绘竟姗€鏌ｉ敐鍥у幋妤犵偛顑夐弫鍐焵椤掑嫭鍊块柛顭戝亖娴滄粓鏌熼悜妯虹仴妞ゅ浚浜弻锝夊箻鐎涙顦伴梺璇″枟椤ㄥ﹪寮幇顓熷劅闁炽儴灏欓崙褰掓⒑鐠囪尙绠版繛瀛樺哺瀹曘垺绂掔€ｎ€箓鏌涢弴銊ョ伇闁轰礁鍟撮弻銊モ攽閸℃ê绐涢梺姹囧€曠€氼剟鈥旈崘顔嘉ч柛鎰╁妿娴犳儳顪冮妶鍐ㄥ闁挎洏鍊濋幃楣冩倻閽樺顔婇梺鐟扮摠濮婂綊寮悩缁樷拺缂備焦锚婵箑霉濠婂嫮鐭嬮柟渚垮姂瀹曟帒鈽夊▎蹇撲紟濠电姷鏁告慨鎾疮椤栫偛桅婵犻潧鐗冮崑鎾舵喆閸曨剙顦╅梺绋款儏閿曘倝鎮鹃悜鑺ュ亜缁炬媽椴搁弲顏堟⒑閸涘﹣绶遍柛鐘崇洴瀵尪顦规慨濠傤煼瀹曟帒鈻庨幋顓熜滈梻浣筋潐缁佹挳鍩€椤掍礁澧繛鍏肩墱閹叉悂鎮ч崼婵堢懆闂佹悶鍔岄崐鍧楀蓟濞戞粠妲煎銈冨妼閻楀棝鎮鹃崹顐ょ懝闁逞屽墴瀵鈽夐姀鐘电杸闂傚倸鐗婄粙鎺楁倶閸繍娓婚柕鍫濋娴滄粓鏌熼搹顐€跨€殿喖顭峰鎾閻樿鏁规繝鐢靛█濞佳兠洪妶鍛瀺闁挎繂娲ㄧ壕钘壝归敐鍥ㄥ殌濠殿喖鐗忕槐鎺斺偓锝庡亜缁椦囨煙楠炲灝鐏╅柍瑙勫灩閳ь剨缍嗛崑鍕濞差亝鈷掗柛灞炬皑婢ф盯鏌涢幒鍡椾壕闂備線娼х换鍫ュ磹閺嶎厼纾归柛顭戝亝閸欏繑鎱ㄥ璇蹭壕濠碘槅鍋夊▔鏇㈡嚍闁秵鍤嶉柕澶堝€楃粻姘舵⒑閸涘﹦鎳冩い锔诲灡閹便劌顓奸崶锝呬壕婵炲牆鐏濋弸鐔兼煙濮濆本鐝柟渚垮姂閸┾偓妞ゆ帒瀚悡鍐⒑濞嗘儳鐏犲ù婊堢畺濮婇缚銇愰幒婵囶棖缂備緡鍣崹鎶藉箲閵忕姭妲堟繛鍡樺姉缁夊爼姊洪崨濠冨瘷闁告劑鍔庨崢鎺楁⒒閸屾瑨鍏屾い銏狅攻閹便劑濡堕崶褍鐏婇柟鑹版彧缁蹭粙宕瑰┑瀣厸闁告劑鍔庢晶娑㈡煕婵犲嫮甯涘ǎ鍥э躬椤㈡盯鎮欑€涙褰哥紓鍌欓檷閸斿矂鈥﹀畡閭︽綎婵炲樊浜濋ˉ鍫熺箾閹达綁鍝烘い搴℃濮婂宕掑顒変患闁诲孩鍑归崜鐔煎箖閹呮殝闁规鍠楀▓鏇㈡⒑闁偛鑻晶鎾煕閳规儳浜炬俊鐐€栫敮鎺楀窗濮橆剦鐒介柟閭﹀幘缁犻箖鏌涘▎蹇ｆ闁兼澘娼￠弻鏇㈠幢濡も偓閺嗭絿鈧娲忛崝宥咁焽韫囨稑绀堢憸蹇涘煟閵堝棛绡€闁汇垽娼у瓭闂佹寧娲忛崐婵嬪箖瑜斿畷鍗炩槈濞嗗繆鍋撻崸妤佺厱妞ゎ厽鍨垫禍鏍瑰⿰鍕煉闁哄瞼鍠栧畷顐﹀礋椤掑顥ｅ┑鐐茬摠缁秹宕曢幎瑙ｂ偓鏃堝礃椤斿槈褔鏌涢埄鍐剧劷闁宠绋撶槐鎾诲磼濮樻瘷锛勭磼閼搁潧鍝哄┑鈥崇摠缁楃喖鍩€椤掆偓椤曪綁骞橀纰辨綂闂佹枼鏅涢崯顖炴偟閺嶎厽鈷掑〒姘ｅ亾闁逞屽墰閸嬫盯鎳熼娑欐珷闁规鍠氱壕鍏笺亜閺傚灝鈷旈悽顖涚〒缁辨帞绱掑Ο鑲╃暤濡炪値鍋呯换鍫ャ€佸鈧幃娆撳级閸噮鍤欓梻鍌氬€搁崐鐑芥倿閿曞倸绠栭柛顐ｆ礀绾炬寧绻濇繝鍌滃缂佲偓閸愨斂浜滈煫鍥ㄦ尵婢с垻鈧娲樼划宀勫煘閹达附鏅柛鏇ㄥ亗閺夘參姊虹粙鍖℃敾闁搞劌鐏濋悾鐑藉即閵忊€虫濡炪倖甯婄粈浣规償婵犲洦鈷戦柛鎾村絻娴滄繄绱掔拠鑼㈡い顓炴喘瀵粙濡歌椤旀洟鎮楅悷鏉款棌闁哥姵娲滈懞閬嶅礂缁楄桨绨婚梺闈涱槶閸庤櫕鏅跺☉姘辩＜缂備焦顭囧ú瀛橆殽閻愬樊鍎旈柟顔界懅閹瑰嫭绗熼娑辨（婵犵绱曢崑鎴﹀磹瑜忓濠冪鐎ｎ亞顔愬銈嗗姧缁犳垿鎮″鈧弻鐔告綇閸撗呮殸闂佺粯鎼换婵嬪蓟濞戙垹鐒洪柛鎰剁細濞岊亞绱撴担闈涘闁告鍥ｂ偓鏃堝礃椤斿槈褔鏌涢幇鈺佸妞ゎ剙鐗撳娲箰鎼淬垹顦╂繛瀛樼矤娴滄繃绌辨繝鍕ㄥ亾濞戞瑯鐒介柣鐔风秺閺屽秷顧侀柛鎾寸懇椤㈡岸鏁愭径妯绘櫔闂侀€炲苯澧柣锝囧厴閹剝鎯斿Ο缁樻澑闂佽鍑界紞鍡樼濠靛姹叉い蹇撶墛閳锋帡鏌涚仦鍓ф噮妞わ讣绠撻弻鐔哄枈閸楃偘绨婚柣鎾卞€濋弻鏇熺箾閻愵剚鐝旈梺姹囧€ら崳锝夊蓟濞戞粠妲煎銈冨妼閹虫劗鍒掓繝姘兼晬婵炴垶姘ㄩ鏇㈡倵閻熸澘顥忛柛鐘虫礈閼鸿鲸绺介崨濠勫幗闂佽宕樺▔娑㈠几濞戙垺鐓涚€光偓鐎ｎ剙鍩岄柧浼欑秮閺屾稑鈹戦崱妤婁患缂備焦顨忛崣鍐潖濞差亝鍋傞幖绮规濡本绻涚€涙鐭ゅù婊庝簻椤曪絿鎷犲ù瀣潔闂侀潧绻掓慨鐢杆夊┑瀣厽闁绘ê鍘栭懜顏堟煕閺傚潡鍙勭€规洘绻堥、娑㈡倷閺夋垟鍋撻崹顐ょ闁割偅绻勬禒銏ゆ煛鐎ｎ剙鏋涢柡宀€鍠栭、娆撴偂鎼存ê浜鹃柛褎顨嗛崑妯汇亜閺冨牊鏆滈柛瀣崌閺佹劖鎯旈埄鍐憾闂備礁鎼幊蹇曞垝閹捐钃熼柨婵嗩槹閺呮煡鏌涘☉娆愮凡妞ゅ浚鍘艰灃闁绘﹢娼ф禒锕傛煕閺冣偓閻熴儵锝炶箛娑欐優閻熸瑥瀚悵浼存⒑閸︻厾甯涢悽顖涘笒琚欓柟閭﹀枤绾句粙鏌涚仦鐐殤鐎涙繂鈹戦埥鍡椾簼闁荤啙鍛灊閻庯綆浜堕崥瀣熆鐠虹尨韬柛鐐茬埣濮婃椽宕崟顒€绐涢梺鍝ュТ鐎涒晝绮嬪鍛傛棃宕ㄩ瑙勫缂傚倷绀侀鍫濃枖閺囩姷涓嶉柟鎯板Г閻撳啰鈧懓瀚竟鍡樻櫠閺囥垺鐓冪紓浣股戠亸鎵磼閸屾稑绗ч柍褜鍓ㄧ紞鍡涘磻閸℃稑鍌ㄥù鐘差儐閳锋垹鎲搁悧鍫濈瑨濞存粈鍗抽弻娑㈠Ω閵堝懎绁梺璇″灠閸熸挳骞栬ぐ鎺戞嵍妞ゆ挾濯寸槐鏌ユ⒒娴ｈ櫣甯涢柨姘繆椤栨熬韬柟顔瑰墲缁轰粙宕ㄦ繝鍕箰闁诲骸鍘滈崑鎾绘倵閿濆骸澧伴柨娑氬枑缁绘稓鈧數枪椤庢挸鈹戦垾铏枠妤犵偛绻橀幃鈺冩嫚閼碱剦鍞介梻浣告贡閸庛倗鎹㈤崟顖氱劦妞ゆ帒鍊搁崢瀛樻叏婵犲嫮甯涚紒妤冨枛閸┾偓妞ゆ帒瀚悞鍨亜閹烘垵鈧憡绂掑⿰鍫熺厾婵炶尪顕ч悘锟犳煛閸涱厾鍩ｇ€规洘绮忛ˇ瀵哥棯閹佸仮婵☆偄鎳橀、鏇㈩敃閵忕姷顔掗梻浣规た閸樹粙鎮烽埡鍛摕闁绘梻鈷堥弫濠囨煟椤撗冧航濞存粠浜弫鎰版倷濞村鏂€闁诲函绲介悘姘跺疾閿濆鍋℃繝濠傚暣閸欏嫭銇勯姀锛勬噰鐎殿噮鍣ｅ畷濂告偄閸欏顏归梻鍌欑閹诧紕绮欓幋锔芥櫇闁靛绠戠欢鐐烘煕閺囥劌鐏￠柣鎾存礋閺屾洘绻涢悙顒佺彃闂佽鐓＄粻鏍蓟濞戙垹鐓涢柛灞剧矋閸掓稑螖閻橀潧浠﹂悽顖ょ節閻涱喗绻濋崶顬晠鏌曟竟顖氭啗閵娾晜鈷戦弶鐐村閸斿秹鏌涢弮鈧悷銉╂偩閻戣姤鍋傞幖鎼枤閸為潧顪冮妶鍡楃瑐闁绘帪濡囨禍鎼佹偨閸涘﹦鍘介梺闈涱樈閸犳洟鏌囬娑栦簻闁靛繆妲勯懓鍧楁煙椤旂晫鎳囨俊顐㈠暙閳藉顫濋鈧粻娲⒒閸屾艾鈧绮堟笟鈧獮鏍敃閿曗偓鐎氬銇勯幒鎴濐仾闁稿骸瀛╅妵鍕冀椤愵澀绮堕梺鍝勵儎缁舵岸寮婚悢鍏肩劷闁挎洍鍋撻柣蹇ョ秮閺岋綁濡堕崒姘闂傚倸鍊风粈渚€骞栭鈷氭椽濡搁敂钘夊伎闂傚倸鐗婄粙鍫ュ几閺冨牊鐓曢煫鍥ㄧ⊕閿涚喓绱掔拠鍙夘棦闁哄本娲熷畷鐓庘攽閸ャ劍鍊烽梺鍝ュ枑閹倸顫忛搹鍦煓婵炲棙鍎抽崜杈╃磽娴ｅ壊鍎愰柟鐟版喘閻涱噣骞嬮敃鈧～鍛存煟濞嗗苯浜惧┑鐐殿儠閸旀垿寮诲鍫闂佸憡鎸婚悷鈺呫€佸鑸垫櫜濠㈣埖蓱閺呮繈姊洪幐搴㈢５闁稿鎸剧槐鎺楁偐閸濆嫬鎯炵紓浣介哺閹稿骞忛崨瀛樺殐闁斥晛鍟悘銉╂煃鐠囪尙效濠殿喒鍋撻梺闈涚墕濡矂骞忓ú顏呯厽闁绘ê鍘栭懜顏堟煕閺傝儻瀚伴柍璇茬Ч楠炲洭鎮ч崼銏犲箥闂備礁鎲￠崹顖炲磹閺嶎偀鍋撳鐐?)  %%%%%%%%%%%%%%%%%%%%%%%%%%
        vector<vector<complex<double>>> Ezy1(NX, vector<complex<double>>(NY));
        vector<vector<complex<double>>> Eyz1(NX, vector<complex<double>>(NY));

        for(int i=1;i<=NX;i++) 
        {
            for(int j=1;j<=NY;j++)
            {
                Ezy1[i-1][j-1]=(Ez1[i-1][j][Nair+NN]-Ez1[i-1][j-1][Nair+NN]+Ez1[i][j][Nair+NN]-Ez1[i][j-1][Nair+NN])/2.0/fmodel.B_Y[j-1];
                Eyz1[i-1][j-1]=(Ey1[i][j-1][Nair+NN+1]-Ey1[i][j-1][Nair+NN]+Ey1[i-1][j-1][Nair+NN+1]-Ey1[i-1][j-1][Nair+NN])/2.0/fmodel.C_Z[Nair+NN];
            }
        }
        //%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Res And Phase %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        complex<double> mysqrt(0,1);
        for(int i=1;i<=NX;i++) 
        {
            for(int j=1;j<=NY;j++)
            {
                Hxx1[i-1][j-1]=1/(mysqrt*w*mu0)*(Ezy1[i-1][j-1]-Eyz1[i-1][j-1]);
                Hyy1[i-1][j-1]=1/(mysqrt*w*mu0)*(Exz1[i-1][j-1]-Ezx1[i-1][j-1]);
                Hzz1[i-1][j-1]=1/(mysqrt*w*mu0)*(Eyx1[i-1][j-1]-Exy1[i-1][j-1]);
                //printf("Hxx1=%e,%e \n",Hxx1[i-1][j-1].real(),Hxx1[i-1][j-1].imag());
                //printf("Hyy1=%e,%e \n",Hyy1[i-1][j-1].real(),Hyy1[i-1][j-1].imag());
               // printf("Hzz1=%e,%e\n",Hzz1[i-1][j-1].real(),Hzz1[i-1][j-1].imag());
            }
        }
    }
    VecDestroy(&P);
    VecDestroy(&Xe);
    KSPDestroy(&ksp_bicg);
    //delete []bufVal;
    //delete  []Bp;
    MatDestroy(&v1);
}
void v1Assembly::fDirBdaries(int groupid)
{
    string s=to_string(groupid);//0/1/2/3
    string f="./data/dataset"+s;
    //{
        if(polarization==1)
        {
            
            importdata(f+"/P2REx.dat",f+"/P2IEx.dat",linshi);
            //importdata(f+"/P2REy.dat",f+"/P2IEy.dat",EyA,m_len);
            //importdata(f+"/P2REz.dat",f+"/P2IEz.dat",EzA,m_len);
            //importdata(f+"/P2RHx.dat",f+"/P2IHx.dat",HxA,m_len);
            //importdata(f+"/P2RHy.dat",f+"/P2IHy.dat",HyA,m_len);
            //Eigen::VectorXd v1=Eigen::VectorXd::Zero(13);
           // HzA.col(0)<<v1; 
            //printf("HzA\n");
        }
   // }

}
//
void v1Assembly::importdata(string f1,string f2,MatrixX &E)
{
    fstream finput1(f1);
    ifstream finput2(f2); 
    string s1;
    string s2;
    int k=0;
    //cout<<f1<<endl;
    //cout<<f2<<endl;
    if (!finput1.is_open()) {
        std::cerr << "Failed to open file: " << f1 << std::endl;
       
    }

    while(!finput1.eof())
    {
       // printf("闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳婀遍埀顒傛嚀鐎氼參宕崇壕瀣ㄤ汗闁圭儤鍨归崐鐐差渻閵堝棗绗掓い锔垮嵆瀵煡顢旈崼鐔蜂画濠电姴锕ら崯鎵不婵犳碍鐓曢柍瑙勫劤娴滅偓淇婇悙顏勨偓鏍暜婵犲洦鍤勯柛顐ｆ礀閻撴繈鏌熼崜褏甯涢柣鎾寸洴閺屾稑鈽夐崡鐐典哗闂佸疇顕ч悧鎾诲蓟閺囥垹骞㈤柡鍥╁濡差噣姊虹€圭媭鍤欓梺甯秮閻涱喖顫滈埀顒€鐣峰鈧獮鎾诲箳閹惧瓨顓瑰┑鐘殿暜缁辨洟宕戦幋锕€纾归柡宥庡幖缁犳澘螖閿濆懎鏆欑痪鎯ь煼閺岋綁寮崹顔藉€梺绋款儐閿曘垽寮婚弴鐔风窞闁糕剝蓱閻濇洟姊洪幎鑺ユ暠闁搞劌娼″璇测槈閵忊剝娅嗛柣鐘叉处瑜板啰绮昏ぐ鎺撯拺闁告稑锕ラ悡銉︺亜閹存繃顥㈠┑锛勬暬瀹曠喖顢涘В灏栨櫊閺屾洘寰勫☉姘辨殸濠电偛鎲為崟顓犵槇闂侀潧楠忕紞鍡楊焽閹邦厾绠鹃柛娆忣樈閻掍粙鏌熼獮鍨仼闁宠鍨垮畷閬嶅煛閸屾艾鍘炲┑锛勫亼閸婃牠骞愰悙顒佸弿闁圭虎鍠氬畵浣衡偓骞垮劚椤︿即鍩涢幒鎳ㄥ綊鏁愰崼鐕佷哗闁汇埄鍨遍惄顖炲蓟濞戙垹绫嶉柟鎯у閺嗐倝鎮楃憴鍕缂侇喖鐭傞敐鐐测攽鐎ｎ偄娈濋梻鍌氱墛缁嬪牓宕戦幘璇查唶闁哄洨鍟块幏鍝勵渻閵堝棗鍧婇柛瀣尵缁辨帗寰勭仦鐐瘓闂佽鍠掗埀顒佹灱濡插牓鏌曡箛銉х？闁告ɑ鎹囬幃宄扳堪閸曨厾鐓夐悗瑙勬礃缁捇骞冮姀銈嗗亗閹艰揪绲块弸鍐⒒娴ｈ櫣甯涢柛鏃€娲熼獮鏍敃閵忊剝娈伴梻鍌氬€烽悞锔锯偓绗涘懏宕查柛灞惧閸嬫挸顫濋悡搴㈢彎闂佽鍨扮€氼參骞嗛弮鍫澪╅柨鏃囶潐鐎氳棄鈹戦悙鑸靛涧缂佽弓绮欓獮澶愭晸閻樿尙鐣鹃梺鍓插亖閸庢煡鎮￠弴銏＄厽闁哄洦姘ㄩˇ锕€霉濠婂嫬顥嬮柍褜鍓濋～澶娒哄鈧畷婵嗏枎閹惧磭鐣洪梺浼欑到閻ジ鎯屽▎鎾村仯濞撴凹鍨抽崢娑㈡煕閻愬灚鏆慨濠勭帛閹峰懘鎳為妷褋鈧﹪姊洪崫銉バｉ柟绋款煼楠炲牓濡搁埡鍌氫缓闂佸憡绋戦敃銈嗙濡ゅ懏鈷戦柛婵嗗閸屻劑鏌涢妸銉﹁础缂侇喛宕甸幉鎾礋椤撶媭鍟庨梻浣瑰缁诲倹顨ラ崨濠冩珷妞ゆ洍鍋撻柡宀嬬秬缁犳盯鏁愰崟顖氫粣闂備浇顕栭崰妤佺仚缂備胶濮电粙鎺楀箚閺冨牆鐏崇€规洖娲㈤崑鏍⒒閸屾瑧顦﹂柟纰卞亰瀵敻顢楅埀顒傚弲闂佺粯妫冮ˉ鎾诲汲閿曞倹鐓欐い鏍仜娴滅増淇婇懠棰濆殭妞ゎ亜鍟存俊鍫曞川椤旂虎娲堕梻浣告啞閿曘垻绮婚弽顓炴槬闁逞屽墯閵囧嫰骞掑鍥獥闂佸摜鍠庣换姗€寮诲☉銏″亹闁归鐒﹂悾璺侯渻閵堝骸骞栨繛灞傚€濋崺銏℃償閵娿儳顔撻梺鍛婃处閸橀箖鍩ｉ妶鍡欑瘈闁汇垽娼ч埢鍫熺箾娴ｅ啿娴傞弫鍕煙閻楀牊绶查柡瀣╃窔閺屾盯鍩勯崘顏佸闂佺粯鎸搁崯浼村箟缁嬪簱鍫柛顐ｇ箘椤︻厼鈹戦悙鏉戠仸闁煎綊绠栧畷鐟扳攽閸″繑鏂€闂佺粯锚瀵墎绮婇埡鍛厸濞达絽澹婇崕鏃堟煛鐏炵晫啸妞ぱ傜窔閺屾盯骞樼捄鐑樼亪闂佺粯渚楅崳锝呯暦濮椻偓婵″憡鎯旈姀鈽嗘闂佺硶鏂侀崑鎾愁渻閵堝棗绗掗悗姘煎墴閹€斥攽鐎ｎ偆鍘甸梺纭咁潐閸旓箓宕靛▎鎾寸厱闁靛ǹ鍎遍埀顒€缍婃俊鐢稿礋椤栨氨鐫勯梺绋挎湰缁嬫帡鎮甸鍫熷仭婵犲﹤鐗嗘禍浼存煕閵娿劍纭炬い顐㈢箳缁辨帒螣鐠囧樊鈧捇姊洪崨濠勨槈闁挎洏鍊濆鎶藉醇閵夛腹鎷洪柣鐔哥懃鐎氼參宕愰幇顔剧＜闁绘ê纾晶顏堟煟閿濆洤鍘撮柟顔ㄥ洤閱囬柣鏂垮槻婵℃娊姊绘笟鈧褔銈悽鐢典笉闁瑰鍋熼々宄扳攽閸屾碍鍟為柍閿嬪灩缁辨挻鎷呮慨鎴邯閹ɑ娼忛妸銈囩畾濡炪倖鍔戦崹褰掝敂椤撱垺鐓涢悘鐐电摂閸庢梻鈧娲栭悥濂搞€佸Δ浣瑰闁告繂瀚粻浼存⒒閸屾瑧鍔嶉柟顔肩埣瀹曟洟顢氶埀顒€顕ｉ幓鎺嗘闁靛繒濮撮崵鎴︽⒑閻熼偊鍤熼柛瀣枔缁粯銈ｉ崘鈺冨幈濠电偞鍨靛畷顒勭嵁濡や降浜滈柕澹唭銉х磼鏉堛劌绗氭繛鐓庣箻婵℃悂鏁冮埀顒勬瀹ュ鈷戦柣鐔告緲濡插鏌熼搹顐€顏堟偩閻戣姤鍊荤紒娑橆儐閺咃絽鈹戦悙鏉戠仸闁荤噥鍨伴…鍥棘鎼存挻鏂€闂佹寧绋戠€氼剚绂嶆總鍛婄厱濠电姴鍟版晶鐢碘偓瑙勬礀缂嶅﹪骞冮悾宀€鐭欓悹鎭掑妿閺嬪啴姊绘繝搴′簻婵炶绠戠叅婵犲﹤鐗婇崕妤€顭块懜闈涘闁绘挻鐟╅弻锝夊箣閻愬棙鍨块幃锟犲Ψ閵夈垺鏂€濡炪倖娲栭幊搴㈡櫠閹绢喗鐓涚€光偓鐎ｎ剛袦闂佽鍣禍顏勭暦閵娾晩鏁婄痪鏉垮綁缁憋拷");
        complex<double> c1;
        if(finput1.fail()||k==datasetSize)
        {
           // printf("闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鐐劤濠€閬嶅焵椤掑倹鍤€閻庢凹鍙冨畷宕囧鐎ｃ劋姹楅梺鍦劋閸ㄥ綊宕愰悙鐑樺仭婵犲﹤鍟扮粻鑽も偓娈垮枟婵炲﹪寮崘顔肩＜婵炴垶鑹鹃獮鍫熶繆閻愵亜鈧倝宕㈡禒瀣瀭闁割煈鍋嗛々鍙夌節闂堟侗鍎愰柣鎾存礃缁绘盯宕卞Δ鍐唺缂備胶濮撮…鐑藉蓟閿涘嫪娌紒瀣仢閳峰鎮楅崹顐ｇ凡閻庢凹鍣ｉ崺鈧い鎺戯功缁夐潧霉濠婂嫮绠炴い銏＄懇瀹曘劑顢樺☉娆愭澑闂備胶绮崝鏇烆嚕閸洖鐓濋柡鍥╀紳閻熸壋鍫柛鏇ㄥ幘閻撳姊虹拠鈥虫灀闁逞屽墯閺嬬厧危閸儲鐓忛煫鍥ュ劤绾惧潡鏌涘Ο鍝勮埞闁宠鍨块幃鈺呭箥瀹ュ懐澧︾€规洘鍨块獮妯肩磼濡厧骞楅梻浣侯攰濞咃綁宕戦悢鍏煎仼闁汇垻顣介崑鎾斥枔閸喗鐏嶉梺缁樻惈缁绘繈濡存笟鈧顕€宕煎┑瀣暪闂備胶绮Λ浣搞€掕ぐ鎺撳仺缂備焦顭囩弧鈧梺姹囧灲濞佳冪摥闂備焦瀵уú蹇涘磹濡ゅ懎鐒垫い鎺嶇閸ゎ剟鏌涢幘璺烘灈妤犵偛鍟～婊堝焵椤掆偓椤曪綁宕奸弴鐐殿吅闂佸搫鍟犻崑鎾绘煛閸屾浜鹃梻鍌氬€烽悞锔锯偓绗涘懐鐭欓柟瀵稿Л閸嬫挸顫濋悡搴＄睄閻庢鍠楁繛濠囥€佸Δ浣虹懝闁搞儺鐓堥崯宥夋⒒娴ｈ櫣甯涢柛鏃€娲栭锝夊醇閺囩偟鐛ュ┑鈽嗗灠閻ㄧ兘宕戦幘鏂ユ灁闁割煈鍠楅悘鍫熺節閳封偓閸愵喖寮板Δ鐘靛仦閸ㄥ灝鐣烽悢纰辨晬婵絽鐨烽弲鐘诲蓟閺囩喎绶為柛顐ｇ箘娴犲吋绻涚€涙鐭掔紒鐘崇墵瀵鏁愭径濠勭杸濡炪倖姊婚崢褎淇婂ú顏呪拺闁规儼濮ら弫閬嶆煕閵娿儳浠㈡い顐㈢箲缁绘繂顫濋鍕暪闂備胶绮Λ渚€顢氳瀹曟粓鏌嗗鍡椾画濠电姴锕ら幊搴ㄣ€傛總鍛婂仺妞ゆ牗绋戠粭褍顭跨憴鍕闁圭懓瀚版俊鎼佸閻樺崬顥氶梺鑽ゅ枑閻熴儳鈧凹鍘剧划鍫ュ焵椤掆偓閳规垿鎮欓懠顒佸嬀闂佸憡姊归崹鍧楃嵁閸愵喗鎯炴い鎰╁€楅惁鍫濃攽椤旀枻渚涢柛姗€绠栧畷銏＄鐎ｎ偀鎷洪悷婊呭鐢帗绂嶆导瀛樼厱闁绘ê纾晶鐢碘偓瑙勬礃缁诲嫰鍩€椤掑﹦绉甸柛鐘愁殜閹繝鎮㈤崗鑲╁幍闂佽鍨庣仦鑺ヮ啀闂備礁鐤囧Λ鍕囨导鏉懳﹂柛鏇ㄥ灱閺佸洭鏌嶉埡浣告殶闁靛棗锕娲捶椤撶喎娈岄柣搴㈢煯閸楁娊鐛崘顕呮晪闁逞屽墮椤曪綁宕奸弴鐐殿吅濠电姴鐏氶崝鏍归崱妞绘斀闁绘ê鐏氶弳鈺佲攽椤曞懎寮鐐茬箻瀹曟﹢顢欓懖鈺佲偓鐐烘⒑閹稿孩顥嗘俊顐㈠瀵悂濡舵径瀣ф嫽婵炶揪绲介幉锟犲箚閸儲鐓涢柛顐亜婢ф壆绱掗鐣屾噰妤犵偞顭囬幏鐘绘嚑椤掆偓婵附淇婇悙顏勨偓鏍暜閹烘鏅濋柨鏂垮⒔閻捇姊婚崼鐔烩偓浠嬫偡閹靛啿鐗氶梺绯曞墲椤洭濡撮幇鐗堢厱婵°倕鎳嶉幉楣冩煛鐏炲墽顬肩紒鐘崇洴瀵挳濡搁妷銉ノユ繝鐢靛仜閻°劎鍒掑鍥у灊闁规崘顕ч拑鐔兼煛閸ャ儱鐏╅梺鍗炴处缁绘繈妫冨☉娆愭倷濠电偛鎷戠紞浣割潖濞差亝鐒婚柣鎰蔼鐎氭澘顭胯閸ｏ綁寮婚敐鍫㈢杸闁哄啫鍊婚悿鍕⒑閹稿海绠橀柛瀣Х缁鈽夐姀鐘插祮闂佺粯顭囬。顔炬閸欏绡€缁剧増蓱椤﹪鏌涢妸褎鏆い銏′亢椤﹁銇勯姀鈩冨磳妤犵偞顭囩槐鎺懳熼柨瀣伖缂傚倸鍊搁崐鐑芥倿閿曞倹鏅梻浣筋嚙妤犲繒绮婚幘璇茶摕闁靛ǹ鍎哄鈺傘亜閹捐泛啸妞ゆ梹娲熷娲礈閹绘帊绨肩紓浣筋嚙鐎氫即骞冮悙鍝勫窛濠电姴鍟鎸庣節閻㈤潧孝闁瑰啿绻橀、鏃堟偐缂佹鍘撻悷婊勭矒瀹曟粌鈽夊Ο閿嬬€洪梺闈涚箞閸婃牠鍩涢弮鍫熺厱闁哄洢鍔屾禍浠嬫煟閺傛寧顥炲ǎ鍥э躬椤㈡稑饪伴崨顓狀偧闂備礁鎲￠悷銉ф崲濮椻偓瀵鈽夊Ο鍏兼畷闂侀€炲苯澧寸€规洘鍨块幃娆撴倻濡桨绨垫繝鐢靛仜濡瑩宕濋幋鐐殿洸婵犲﹤鐗婇悡娑㈡煕鐏炲墽绠ラ柛銈嗙懃閳规垿鍨鹃崘鍙夊€紓浣虹帛缁嬫捇骞忛悩渚Ь闂佷紮绲块弫鎼佸焵椤掑喚娼愭繛鍙夛耿瀹曟繂鈻庨幘宕囩暫濠电姴锕ら悧濠囧吹瀹ュ鐓忓璇″灠閸燁偆绮婚悙娴嬫斀闁绘ê鐏氶弳鈺佲攽閻愨晛浜炬繝鐢靛仒閸栫娀宕楅悙顒傗槈閾绘牠鏌涘⿰鈧悞锕傚疾濠婂喚娓婚柕鍫濇婵囨⒒閸曨偄顏柟顕嗙節瀵挳濮€閿涘嫬骞愰梻浣告啞閸斿繘寮插⿰鍛剨闁汇垹鎲￠悡鐔兼煥濠靛棛澧﹂柛婵囨そ閺屾洟宕惰椤忣厽銇勯姀鈩冾棃鐎规洜鍠栭、鏇㈡晲閸♀晛鏅┑鐘垫暩婵兘銆傛禒瀣劦妞ゆ巻鍋撶痪缁㈠弮瀹曟椽鏁愰崶锝呬壕閻熸瑥瀚粈鈧悗瑙勬处閸撴繈鎮橀崘顔解拺闂侇偆鍋涢懟顖涙櫠椤斿浜滄い鎾跺仦閸犳ɑ顨ラ悙宸剶闁轰礁鍊婚幉鎾晲閸℃浼栫紓鍌氬€搁崐椋庣矆娓氣偓椤㈡牠宕卞☉杈ㄦ櫈濠电偛妫欓幐鍝ュ閸ф鐓欓柟娈垮枛椤ｅジ鏌ｉ幘瀵告噰闁哄瞼鍠栧鑽ゅ鐎ｎ亜甯梻浣风串缁叉儳顪冩禒瀣摕婵炴垯鍨归悡姗€鏌熼鍡楀€搁ˉ姘節绾板纾块柛瀣灴瀹曟劙寮介锝嗘闂佸湱鍎ら〃鍛玻濡や焦鍙忔慨妤€妫楁晶濠氭煟閹哄秶鐭欓柡宀€鍠栭弻鍥晝閳ь剟鐛Ο鑲╃＜闁绘﹢娼ф禍鍓х磼缂佹娲寸€殿喖鐖奸獮瀣敇閻愭彃顥庡┑鐘垫暩閸嬫盯骞婃惔銊︽櫇闁靛鏂傞埀顒€鍟存俊鐑藉煛閸屾埃鍋撻悜鑺ョ厾缁炬澘宕晶鐗堛亜閺冣偓鐢€愁潖閻戞ɑ濮滈柟娈垮枛婵′粙姊洪崷顓熷殌婵炲樊鍘奸锝夘敃閿曗偓缁犺崵绱撴担鑲℃垵鈻嶉姀銈嗏拺閻犳亽鍔屽▍鎰版煙閸戙倖瀚�==13\n");
            break;
        }
        finput1>>s1;
        finput2>>s2;
        c1.real(stod(s1));
        c1.imag(stod(s2));
        E(k)=c1;
        //printf("c1(%d)=(%e,%e)\n",k,real(c1),imag(c1));
        k++;
    }
    finput1.close();
    finput2.close();
}